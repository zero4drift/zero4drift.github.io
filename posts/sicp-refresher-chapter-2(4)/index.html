<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Refresher of SICP chapter 2.4 abstraction data 构造数据抽象">
<meta name="viewport" content="width=device-width">
<title>SICP-Refresher-Chapter-2(4) | 钉钉是世界上最傻逼的app</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://zero4drift.github.io/posts/sicp-refresher-chapter-2%284%29/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="zero4drift">
<meta property="og:site_name" content="钉钉是世界上最傻逼的app">
<meta property="og:title" content="SICP-Refresher-Chapter-2(4)">
<meta property="og:url" content="https://zero4drift.github.io/posts/sicp-refresher-chapter-2%284%29/">
<meta property="og:description" content="Refresher of SICP chapter 2.4 abstraction data 构造数据抽象">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-12-24T14:41:29+08:00">
<meta property="article:tag" content="Scheme">
<meta property="article:tag" content="SICP">
</head>
<body>
    

    <header id="header" class="navbar"><div class="container">
            
    <div class="brand">

        <div class="brand-text">
            <a href="https://zero4drift.github.io/" title="钉钉是世界上最傻逼的app" rel="home">
                钉钉是世界上最傻逼的app
            </a>
        </div>

        <a id="btn-toggle-nav" class="navbar-toggle">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
    </div>

            
    <nav class="navbar-collapse collapse"><ul class="nav">
<li><a href="../../archive.html">Archive</a></li>
                <li><a href="https://github.com/zero4drift">Github</a></li>
                <li><a href="../../categories/">Tags</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>
    
    
    </ul></nav>
</div>
    </header><div class="header-padding"> </div>

    
    <div class="post-header">
        <div class="container">
            <div class="title">
                SICP-Refresher-Chapter-2(4)
            </div>
        </div>
    </div>

    <div class="post-meta">
      <div class="container">
	<div class="meta clearfix">
	  <div class="authordate">
	    <time class="timeago" datetime="2018-12-24T14:41:29+08:00">2018/12/24</time>
</div>
	  <div class="post-tags">
	    <div class="tag">
	      <a href="../../categories/scheme/" rel="tag">Scheme</a>
	    </div>
	    <div class="tag">
	      <a href="../../categories/sicp/" rel="tag">SICP</a>
	    </div>
	  </div>
	</div>
      </div>
    </div>
    
    
    <div id="post-main" class="main">
        <div class="container">
        <div id="outline-container-orgeda819d" class="outline-2">
<h2 id="orgeda819d">抽象数据的多重表示</h2>
<div class="outline-text-2" id="text-orgeda819d">
<ol class="org-ol">
<li>对于一个数据对象可能存在多种有用的表示形式，而且也可能希望所设计的系统能处
理多种表示形式；</li>
<li>除了需要将表示与使用相隔离的数据抽象屏障之外，还需要有抽象屏障去隔离互不相
同的设计选择，以便允许不同的设计选择在同一个程序里共存；</li>
<li>进一步说，由于大型程序常常是通过组合起一些现存模块构造起来的，而这些模块又
是独立设计的，我们也需要一些方法，使程序员可能逐步地将许多模块结合成一个大
型系统，而不必去重新设计或者重新实现这些模块；</li>
<li>本节构造通用型过程（可以在不止一种数据表示上操作的过程）所采用的主要技术，
是让它们在带有 <b>类型标志</b> 的数据对象上操作（即让这些数据对象包含着它们应该
如何被处理的明确信息）；</li>
<li>本节还讨论 <b>数据导向</b> 的程序设计，这是一种用于构造采用了通用型操作的系统的
有力而且方便的技术；</li>
</ol>
</div>

<div id="outline-container-org4e62522" class="outline-3">
<h3 id="org4e62522">复数的表示</h3>
<div class="outline-text-3" id="text-org4e62522">
<ol class="org-ol">
<li>复数表示为有序对的两种可能表示方式：直角坐标形式（实部和虚部）以及极坐标
形似（模和幅角）；</li>
<li>复数的两种不同表示方式，分别适合不同的运算（直角坐标适合加减，极坐标适合
乘除）；</li>
<li>从编写使用复数的程序的开发人员角度看，数据抽象原理的建议是所有复数操作都
应该可以使用，无论计算机所用的具体表示形式是什么；</li>
</ol>
</div>
</div>

<div id="outline-container-org39c86f5" class="outline-3">
<h3 id="org39c86f5">带标帜数据</h3>
<div class="outline-text-3" id="text-org39c86f5">
<ol class="org-ol">
<li>最小允诺原则：在实现程序时，由选择函数和构造函数形成抽象屏障，使我们可以
把为自己所用的数据对象选择具体表示形式的事情尽量向后推，而且还能保持系统
设计的最大灵活性；</li>
<li>本节例子的最终形态将数据对象从一个层次传到另一个层次的过程中，剥去和加上
标志的规范方式可以成为一种重要的组织策略；</li>
</ol>
</div>
</div>

<div id="outline-container-org139644e" class="outline-3">
<h3 id="org139644e">数据导向的程序设计和可加性</h3>
<div class="outline-text-3" id="text-org139644e">
<ol class="org-ol">
<li>检查一个数据项的类型，并据此去调用某个适当过程成为基于类型的分派，这在系
统设计中是一种获得模块性的强有力策略；</li>
<li>
<b>数据导向</b> 的程序设计技术就是一种使程序能直接利用类似 <b>类型－操作</b> 二维表
格工作的程序设计技术，表格中 <b>作为元素的过程</b> 针对作为参数的每个类型实现
每一个操作，能够将系统设计进一步模块化；</li>
<li>章节 2.4.2 让每个操作管理自己的分派，实际上就是把 2.4.3 中的二维表格分解
为一行一行，让每个通用型过程表示表格中的一行；</li>
<li>另一种实现策略是将这一表格按列进行分解，采用“智能数据对象”（其实就是将数
据对象用过程来表示，关键词 dispatch）让它们基于操作名完成所需的分派工作，
这种策略就是 <b>消息传递</b> （将数据对象设想为一个实体，以“消息”的方式接收到
所需操作的名字）；</li>
<li>消息传递是一种有价值的技术，第三章将会详细讨论并用于构造模拟程序。</li>
</ol>
</div>
</div>

<div id="outline-container-org268223f" class="outline-3">
<h3 id="org268223f">练习 2.73-2.76</h3>
<div class="outline-text-3" id="text-org268223f">
</div>
<div id="outline-container-orgdc2dcdf" class="outline-4">
<h4 id="orgdc2dcdf">2.73</h4>
<div class="outline-text-4" id="text-orgdc2dcdf">
<div class="highlight"><pre><span></span>     <span class="c1">;; a</span>

     <span class="c1">;; 数字和符号是 scheme 的基本元素，有语言内置的过程可以识别和区分；而且区分之后</span>
     <span class="c1">;; 直接返回数值，并不需要过程计算（如果一定要全部都使用表格分发也行，但改动较多</span>
     <span class="c1">;; 且无必要）；</span>

     <span class="c1">;; b &amp; c</span>

     <span class="c1">;;其余过程和 3.3.2 实例及乘幂求导练习一致</span>
     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">addend</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">s</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">augend</span> <span class="nv">s</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">s</span><span class="p">))</span>
	   <span class="mi">0</span>
	   <span class="p">(</span><span class="nb">cons </span><span class="ss">'+</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">s</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">multiplier</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">p</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">p</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))</span>
	   <span class="mi">1</span>
	   <span class="p">(</span><span class="nb">cons </span><span class="ss">'*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">exponent</span> <span class="nv">x</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cadr </span><span class="nv">x</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">base</span> <span class="nv">x</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">car </span><span class="nv">x</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">deriv-product</span> <span class="nv">operands</span> <span class="nv">var</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">make-sum</span>
	<span class="p">(</span><span class="nf">make-product</span> <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">operands</span><span class="p">)</span>
		      <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">var</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">make-product</span> <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">var</span><span class="p">)</span>
		      <span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">operands</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">deriv-sum</span> <span class="nv">operands</span> <span class="nv">var</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">make-sum</span> <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">addend</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">var</span><span class="p">)</span>
		 <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">augend</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">var</span><span class="p">)))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">deriv-exponentiation</span> <span class="nv">operands</span> <span class="nv">var</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">make-product</span> <span class="p">(</span><span class="nf">exponent</span> <span class="nv">operands</span><span class="p">)</span>
		     <span class="p">(</span><span class="nf">make-product</span>
		      <span class="p">(</span><span class="nf">make-exponentiation</span>
		       <span class="p">(</span><span class="nf">base</span> <span class="nv">operands</span><span class="p">)</span>
		       <span class="p">(</span><span class="nf">make-sum</span> <span class="p">(</span><span class="nf">exponent</span> <span class="nv">operands</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="mi">1</span><span class="p">)))</span>
		      <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">base</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">var</span><span class="p">))))</span>

     <span class="c1">;; install</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">install-deriv-package</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">put</span> <span class="ss">'deriv</span> <span class="ss">'*</span> <span class="nv">deriv-product</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">put</span> <span class="ss">'deriv</span> <span class="ss">'+</span> <span class="nv">deriv-sum</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">put</span> <span class="ss">'deriv</span> <span class="ss">'**</span> <span class="nv">deriv-exponentiation</span><span class="p">))</span>

     <span class="c1">;; d</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">install-deriv-package</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">put</span> <span class="ss">'*</span> <span class="ss">'deriv</span> <span class="nv">deriv-product</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">put</span> <span class="ss">'+</span> <span class="ss">'deriv</span> <span class="nv">deriv-sum</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">put</span> <span class="ss">'**</span> <span class="ss">'deriv</span> <span class="nv">deriv-exponentiation</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org845f349" class="outline-4">
<h4 id="org845f349">2.74</h4>
<div class="outline-text-4" id="text-org845f349">
<div class="highlight"><pre><span></span>     <span class="c1">;; 以前自己的解答，就不翻译了</span>
     <span class="c1">;; a</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">get-record</span> <span class="nv">name</span> <span class="nv">file</span><span class="p">)</span>
       <span class="p">((</span><span class="nf">get</span> <span class="ss">'get-record</span> <span class="p">(</span><span class="nf">tag</span> <span class="nv">file</span><span class="p">))</span> <span class="nv">name</span> <span class="p">(</span><span class="nf">contents</span> <span class="nv">file</span><span class="p">)))</span>

     <span class="c1">;; file (cons tag (cons name record) ... ) or some other structures</span>
     <span class="c1">;; (put 'get-record the-exact-tag the-exact-get-record-procedure)</span>


     <span class="c1">;; b</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">get-salary</span> <span class="nv">name</span> <span class="nv">file</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">record</span> <span class="p">(</span><span class="nf">get-record</span> <span class="nv">name</span> <span class="nv">file</span><span class="p">)))</span>
	 <span class="p">((</span><span class="nf">get</span> <span class="ss">'get-salary</span> <span class="p">(</span><span class="nf">tag</span> <span class="nv">record</span><span class="p">))</span> <span class="p">(</span><span class="nf">contents</span> <span class="nv">record</span><span class="p">))))</span>

     <span class="c1">;; record (cons tag salary-content ...) or some other structures</span>
     <span class="c1">;; put behaves like a</span>


     <span class="c1">;; c</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">find-employee-record</span> <span class="nv">name</span> <span class="nv">file-list</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">file-list</span> <span class="nv">result</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">null? </span><span class="nv">file-list</span><span class="p">)</span> <span class="nv">result</span><span class="p">)</span>
	       <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nf">get-record</span> <span class="nv">name</span> <span class="p">(</span><span class="nb">car </span><span class="nv">file-list</span><span class="p">)))</span>
		<span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">file-list</span><span class="p">)</span> <span class="nv">result</span><span class="p">))</span>
	       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">file-list</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">get-record</span> <span class="nv">name</span> <span class="p">(</span><span class="nb">car </span><span class="nv">file-list</span><span class="p">))</span> <span class="nv">results</span><span class="p">)))))</span>
       <span class="p">(</span><span class="nf">iter</span> <span class="nv">file-list</span> <span class="o">'</span><span class="p">()))</span>


     <span class="c1">;; d</span>

     <span class="c1">;; if possible, give new and unique tags to this file and its certain records</span>
     <span class="c1">;; with the procedure 'put' and new tags, install the corresponding procedures</span>
</pre></div>
</div>
</div>

<div id="outline-container-orge031389" class="outline-4">
<h4 id="orge031389">2.75</h4>
<div class="outline-text-4" id="text-orge031389">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-from-mag-ang</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">dispatch</span> <span class="nv">op</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">eq? </span><span class="nv">op</span> <span class="ss">'magnitude</span><span class="p">)</span> <span class="nv">x</span><span class="p">)</span>
	       <span class="p">((</span><span class="nb">eq? </span><span class="nv">op</span> <span class="ss">'angle</span><span class="p">)</span> <span class="nv">y</span><span class="p">)</span>
	       <span class="p">((</span><span class="nb">eq? </span><span class="nv">op</span> <span class="ss">'real-part</span><span class="p">)</span>
		<span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="p">(</span><span class="nb">cos </span><span class="nv">y</span><span class="p">)))</span>
	       <span class="p">((</span><span class="nb">eq? </span><span class="nv">op</span> <span class="ss">'imag-part</span><span class="p">)</span>
		<span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="p">(</span><span class="nb">sin </span><span class="nv">y</span><span class="p">)))</span>
	       <span class="p">(</span><span class="nf">else</span>
		<span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown op -- MAKE-FROM-MAG-ANG"</span> <span class="nv">op</span><span class="p">))))</span>
       <span class="nv">dispatch</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org2409842" class="outline-4">
<h4 id="org2409842">2.76</h4>
<div class="outline-text-4" id="text-org2409842">
<div class="highlight"><pre><span></span>     <span class="c1">;; 带有显式分派的通用型操作在加入一个新类型或者新操作时对代码的改动较大，带来不</span>
     <span class="c1">;; 便，容易引进错误</span>

     <span class="c1">;; 消息传递更适合用于需要经常加入新的数据对象类型的系统；</span>

     <span class="c1">;; 数据导向更适合用于需要经常加入新的操作的系统（存疑，经常加入新的操作的话，使用消息传递风格并不会更麻烦）；</span>
</pre></div>
</div>
</div>
</div>
</div>
            
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="https-zero4drift-github-io",
            disqus_url="https://zero4drift.github.io/posts/sicp-refresher-chapter-2%284%29/",
        disqus_title="SICP-Refresher-Chapter-2(4)",
        disqus_identifier="cache/posts/sicp-refresher-chapter-2(4).html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        
    


        </div>
    </div>

    
    <footer><div class="container">
            <div class="social">



                <div class="social-entry">
                    <a href="../../rss.xml" target="_blank">
                        <i class="fa fa-rss"></i> 
                    </a>
                </div>
            </div>
                <div class="copyright">
                    Contents © 2019         <a href="mailto:fang0052@e.ntu.edu.sg">zero4drift</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
                    
                </div>
           
        </div>
    </footer><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?06e0ade16d98033ac1aad78106d873c8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script src="../../assets/js/all-nocdn.js" type="text/javascript"></script>
</body>
</html>
