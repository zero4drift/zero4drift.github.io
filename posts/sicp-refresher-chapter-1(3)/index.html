<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Refresher of SICP chapter 1.3 abstraction procedure 构造过程抽象">
<meta name="viewport" content="width=device-width">
<title>SICP-Refresher-Chapter-1(3) | 钉钉是世界上最傻逼的app</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://zero4drift.github.io/posts/sicp-refresher-chapter-1%283%29/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="zero4drift">
<meta property="og:site_name" content="钉钉是世界上最傻逼的app">
<meta property="og:title" content="SICP-Refresher-Chapter-1(3)">
<meta property="og:url" content="https://zero4drift.github.io/posts/sicp-refresher-chapter-1%283%29/">
<meta property="og:description" content="Refresher of SICP chapter 1.3 abstraction procedure 构造过程抽象">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-12-16T14:29:21+08:00">
<meta property="article:tag" content="Scheme">
<meta property="article:tag" content="SICP">
</head>
<body>
    

    <header id="header" class="navbar"><div class="container">
            
    <div class="brand">

        <div class="brand-text">
            <a href="https://zero4drift.github.io/" title="钉钉是世界上最傻逼的app" rel="home">
                钉钉是世界上最傻逼的app
            </a>
        </div>

        <a id="btn-toggle-nav" class="navbar-toggle">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
    </div>

            
    <nav class="navbar-collapse collapse"><ul class="nav">
<li><a href="../../archive.html">Archive</a></li>
                <li><a href="https://github.com/zero4drift">Github</a></li>
                <li><a href="../../categories/">Tags</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>
    
    
    </ul></nav>
</div>
    </header><div class="header-padding"> </div>

    
    <div class="post-header">
        <div class="container">
            <div class="title">
                SICP-Refresher-Chapter-1(3)
            </div>
        </div>
    </div>

    <div class="post-meta">
      <div class="container">
	<div class="meta clearfix">
	  <div class="authordate">
	    <time class="timeago" datetime="2018-12-16T14:29:21+08:00">2018/12/16</time>
</div>
	  <div class="post-tags">
	    <div class="tag">
	      <a href="../../categories/scheme/" rel="tag">Scheme</a>
	    </div>
	    <div class="tag">
	      <a href="../../categories/sicp/" rel="tag">SICP</a>
	    </div>
	  </div>
	</div>
      </div>
    </div>
    
    
    <div id="post-main" class="main">
        <div class="container">
        <div id="outline-container-orgbd533bc" class="outline-2">
<h2 id="orgbd533bc">用高阶函数做抽象</h2>
<div class="outline-text-2" id="text-orgbd533bc">
<ol class="org-ol">
<li>过程提供了这样的能力：
<ol class="org-ol">
<li>能为公共的模式命名，建立抽象；</li>
<li>直接在抽象的层次上工作。</li>
</ol>
</li>
<li>如果不同的过程具有同样的设计模式，可以将这种模式提取出来构成高阶过程：
<ol class="org-ol">
<li>它以过程为参数，以不同的过程参数调用可以实现前面所讲的具有相同设计模式
的不同的过程的功能；</li>
<li>可以将过程作为返回值；</li>
<li>是强有力的抽象机制，极大地增强语言的表述能力。</li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-orga39fd88" class="outline-3">
<h3 id="orga39fd88">过程作为参数</h3>
<div class="outline-text-3" id="text-orga39fd88">
<ol class="org-ol">
<li>以序列求和中的抽象模式引出以过程作为参数的主题。</li>
</ol>
</div>
</div>

<div id="outline-container-org07a7829" class="outline-3">
<h3 id="org07a7829">练习 1.29-1.33</h3>
<div class="outline-text-3" id="text-org07a7829">
</div>
<div id="outline-container-orgc1006f1" class="outline-4">
<h4 id="orgc1006f1">1.29</h4>
<div class="outline-text-4" id="text-orgc1006f1">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">integral-simpson</span> <span class="nv">f</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="nv">h</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">n</span><span class="p">))</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">compute</span> <span class="nv">count</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">count</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="p">(</span><span class="nb">* </span><span class="nv">count</span> <span class="nv">h</span><span class="p">))))</span>
	       <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">count</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">4</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="p">(</span><span class="nb">* </span><span class="nv">count</span> <span class="nv">h</span><span class="p">)))))</span>
	       <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">count</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="p">(</span><span class="nb">* </span><span class="nv">count</span> <span class="nv">h</span><span class="p">)))))))</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">count-next</span> <span class="nv">count</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">+ </span><span class="nv">count</span> <span class="mi">1</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">/ </span><span class="nv">h</span> <span class="mi">3</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">sum</span> <span class="nv">compute</span> <span class="mi">0</span> <span class="nv">count-next</span> <span class="nv">n</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org35a8b06" class="outline-4">
<h4 id="org35a8b06">1.30</h4>
<div class="outline-text-4" id="text-org35a8b06">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
	     <span class="nv">result</span>
	     <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
       <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgb0c6dbc" class="outline-4">
<h4 id="orgb0c6dbc">1.31</h4>
<div class="outline-text-4" id="text-orgb0c6dbc">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
	   <span class="mi">1</span>
	   <span class="p">(</span><span class="nf">*</span>
	    <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
	    <span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span>

     <span class="c1">;; a</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">compute-next</span> <span class="nv">y</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+ </span><span class="nv">y</span> <span class="mi">1</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">keep-same</span> <span class="nv">x</span><span class="p">)</span>
	 <span class="nv">x</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">product</span> <span class="nv">keep-same</span> <span class="mi">1</span> <span class="nv">compute-next</span> <span class="nv">n</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">compute-pi</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">pi-term</span> <span class="nv">n</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">))))</span>
       <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">product</span> <span class="nv">pi-term</span> <span class="mi">1</span> <span class="nv">compute-next</span> <span class="nv">n</span><span class="p">)</span>
	  <span class="mi">4</span><span class="p">))</span>

     <span class="c1">;; b</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">product-iter</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
	     <span class="nv">result</span>
	     <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">result</span> <span class="nv">term</span><span class="p">(</span><span class="nf">a</span><span class="p">)))))</span>
       <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orge088185" class="outline-4">
<h4 id="orge088185">1.32</h4>
<div class="outline-text-4" id="text-orge088185">
<div class="highlight"><pre><span></span>     <span class="c1">;; a</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
	   <span class="nv">null-value</span>
	   <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">b</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">*</span> <span class="mi">1</span> <span class="nv">term</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span>

     <span class="c1">;; b</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">accumulate-iter</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
	     <span class="nv">result</span>
	     <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">result</span><span class="p">))))</span>
       <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">null-value</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org236a319" class="outline-4">
<h4 id="org236a319">1.33</h4>
<div class="outline-text-4" id="text-org236a319">
<div class="highlight"><pre><span></span>     <span class="c1">;; (load "./1.20.scm")</span>
     <span class="c1">;; (load "./1.21.scm")</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">filter</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">null-value</span><span class="p">)</span>
	     <span class="p">((</span><span class="nf">filter</span> <span class="nv">a</span><span class="p">)</span>
	      <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
			<span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">filter</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)))</span>
	     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">filter</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">keep-same</span> <span class="nv">n</span><span class="p">)</span>
	 <span class="nv">n</span><span class="p">)</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">compute-next</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>

     <span class="c1">;; a</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">prime-sum</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">prime?</span> <span class="nv">+</span> <span class="mi">0</span> <span class="nv">keep-same</span> <span class="nv">a</span> <span class="nv">compute-next</span> <span class="nv">b</span><span class="p">))</span>

     <span class="c1">;; b</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">gcd-product</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">gcd-equals-1?</span> <span class="nv">a</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">gcd </span><span class="nv">a</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">gcd-equals-1?</span> <span class="nv">*</span> <span class="mi">1</span> <span class="nv">keep-same</span> <span class="mi">1</span> <span class="nv">compute-next</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org684e145" class="outline-3">
<h3 id="org684e145">用 lambda 构造过程</h3>
<div class="outline-text-3" id="text-org684e145">
<ol class="org-ol">
<li>lambda:
<ol class="org-ol">
<li>用与 define 同样的方式创建过程，除了不为有关过程提供名字之外，两者创建
的过程完全一样；</li>
<li>仅有的不同之处就是这种过程没有与环境中的任何名字相关联；</li>
<li>lambda 表达式可以用在任何通常使用过程名的上下文中。</li>
</ol>
</li>
<li>let:
<ol class="org-ol">
<li>let 表达式只是作为其基础的 lambda 表达式的语法外衣罢了；</li>
<li>let 使人能在尽可能接近其使用的地方建立局部变量约束；</li>
<li>let 表达式描述的变量的值是在 let 最终创建的作用域之外计算的。</li>
</ol>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgae57f2e" class="outline-3">
<h3 id="orgae57f2e">练习 1.34</h3>
<div class="outline-text-3" id="text-orgae57f2e">
</div>
<div id="outline-container-orgcced820" class="outline-4">
<h4 id="orgcced820">1.34</h4>
<div class="outline-text-4" id="text-orgcced820">
<div class="highlight"><pre><span></span>    <span class="c1">;; (f f)</span>
    <span class="c1">;; (f 2)</span>
    <span class="c1">;; (2 2)</span>
    <span class="c1">;; error, the object 2 is not applicable.</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org6cfb99b" class="outline-3">
<h3 id="org6cfb99b">过程作为一般性的方法</h3>
<div class="outline-text-3" id="text-org6cfb99b">
<ol class="org-ol">
<li>一般性(general)方法的两个更精细的实例：
<ol class="org-ol">
<li>找出函数零点；</li>
<li>找出函数不动点；</li>
</ol>
</li>
<li>一般性过程与其中涉及的特定函数无关，只要函数都符合一般性过程要求的特征
（如参数个数，返回值类型等），而不用考虑函数到底是怎样进行特定计算过程的。</li>
</ol>
</div>
</div>

<div id="outline-container-org6fbe97e" class="outline-3">
<h3 id="org6fbe97e">练习 1.35-1.39</h3>
<div class="outline-text-3" id="text-org6fbe97e">
</div>
<div id="outline-container-orgd169ad6" class="outline-4">
<h4 id="orgd169ad6">1.35</h4>
<div class="outline-text-4" id="text-orgd169ad6">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="nv">tolerance</span> <span class="mf">0.00001</span><span class="p">)</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span> <span class="nv">first-guess</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">v1</span> <span class="nv">v2</span><span class="p">))</span> <span class="nv">tolerance</span><span class="p">))</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">try</span> <span class="nv">guess</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">next</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span>
	   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">guess</span> <span class="nv">next</span><span class="p">)</span>
	       <span class="nv">next</span>
	       <span class="p">(</span><span class="nf">try</span> <span class="nv">next</span><span class="p">))))</span>
       <span class="p">(</span><span class="nf">try</span> <span class="nv">first-guess</span><span class="p">))</span>

     <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">/ </span><span class="mi">1</span> <span class="nv">x</span><span class="p">)))</span> <span class="mf">1.0</span><span class="p">)</span> <span class="c1">;1.618.327...</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgc38809e" class="outline-4">
<h4 id="orgc38809e">1.36</h4>
<div class="outline-text-4" id="text-orgc38809e">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="nv">tolerance</span> <span class="mf">0.00001</span><span class="p">)</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">report-evolution</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">display </span><span class="s">" *** "</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">display </span><span class="nv">n</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span> <span class="nv">first-guess</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">v1</span> <span class="nv">v2</span><span class="p">))</span> <span class="nv">tolerance</span><span class="p">))</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">try</span> <span class="nv">guess</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">report-evolution</span> <span class="nv">guess</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">next</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span>
	   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">guess</span> <span class="nv">next</span><span class="p">)</span>
	       <span class="nv">next</span>
	       <span class="p">(</span><span class="nf">try</span> <span class="nv">next</span><span class="p">))))</span>
       <span class="p">(</span><span class="nf">try</span> <span class="nv">first-guess</span><span class="p">))</span>

     <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">log </span><span class="mi">1000</span><span class="p">)</span> <span class="p">(</span><span class="nb">log </span><span class="nv">x</span><span class="p">)))</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">;&gt;20 steps</span>

     <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">log </span><span class="mi">1000</span><span class="p">)</span> <span class="p">(</span><span class="nb">log </span><span class="nv">x</span><span class="p">))))</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">;only 9 steps on my computer</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgfd0d63a" class="outline-4">
<h4 id="orgfd0d63a">1.37</h4>
<div class="outline-text-4" id="text-orgfd0d63a">
<div class="highlight"><pre><span></span>     <span class="c1">;; 0.6180...</span>

     <span class="c1">;; recursive</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cont-frac</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">recursive</span> <span class="nv">count</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">count</span> <span class="nv">k</span><span class="p">)</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nf">d</span> <span class="nv">count</span><span class="p">))</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">d</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nf">recursive</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">count</span> <span class="mi">1</span><span class="p">))))))</span>
       <span class="p">(</span><span class="nf">recursive</span> <span class="mi">1</span><span class="p">))</span>

     <span class="p">(</span><span class="nf">cont-frac</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
		<span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
		<span class="mi">11</span><span class="p">)</span>			<span class="c1">; generates 0.6180555... after 11 steps</span>

     <span class="c1">;; iterative</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cont-frac-iter</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">count</span> <span class="nv">result</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">count</span> <span class="nv">k</span><span class="p">)</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">count</span><span class="p">)</span>
		<span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">d</span> <span class="nv">count</span><span class="p">)</span> <span class="nv">result</span><span class="p">))</span>
	     <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">count</span> <span class="mi">1</span><span class="p">)</span>
		   <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">count</span><span class="p">)</span>
		      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">d</span> <span class="nv">count</span><span class="p">)</span> <span class="nv">result</span><span class="p">)))))</span>
       <span class="p">(</span><span class="nf">iter</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>

     <span class="p">(</span><span class="nb">/ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">cont-frac-iter</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
			  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
			  <span class="mi">11</span><span class="p">))</span>		<span class="c1">;also requires 11 steps</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3b070f3" class="outline-4">
<h4 id="org3b070f3">1.38</h4>
<div class="outline-text-4" id="text-org3b070f3">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">compute-next</span> <span class="nv">i</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="nv">the-count</span> <span class="mi">1</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="nv">the-number</span> <span class="mi">2</span><span class="p">)</span>
       <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">the-count</span> <span class="nv">i</span><span class="p">)</span> <span class="nv">the-number</span><span class="p">)</span>
	     <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">- </span><span class="nv">i</span> <span class="nv">the-count</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
	      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="nv">i</span> <span class="nv">the-count</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">the-number</span><span class="p">))</span>
	     <span class="p">(</span><span class="k">else </span><span class="mi">1</span><span class="p">)))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cont-frac</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">recursive</span> <span class="nv">count</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">count</span> <span class="nv">k</span><span class="p">)</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nf">d</span> <span class="nv">count</span><span class="p">))</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">d</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nf">recursive</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">count</span> <span class="mi">1</span><span class="p">))))))</span>
       <span class="p">(</span><span class="nf">recursive</span> <span class="mi">0</span><span class="p">))</span>

     <span class="p">(</span><span class="nf">cont-frac</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span> <span class="nv">compute-next</span> <span class="mi">10</span><span class="p">)</span> <span class="c1">;0.718281822... e: 2.718281828...</span>
</pre></div>
</div>
</div>

<div id="outline-container-org11fe9e2" class="outline-4">
<h4 id="org11fe9e2">1.39</h4>
<div class="outline-text-4" id="text-org11fe9e2">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">higher-level-cont-frac</span> <span class="nv">combiner</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">recursive</span> <span class="nv">count</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">count</span> <span class="nv">k</span><span class="p">)</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nf">d</span> <span class="nv">count</span><span class="p">))</span>
	     <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="nf">d</span> <span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nf">recursive</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">count</span> <span class="mi">1</span><span class="p">))))))</span>
       <span class="p">(</span><span class="nf">recursive</span> <span class="mi">1</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">tan-cf</span> <span class="nv">x</span> <span class="nv">k</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">higher-level-cont-frac</span> <span class="nv">-</span>
			       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)))</span>
			       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">* </span><span class="nv">i</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
			       <span class="nv">k</span><span class="p">))</span>
     <span class="c1">;; test</span>

     <span class="p">(</span><span class="k">define </span><span class="nv">tan60</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">sqrt </span><span class="mi">3</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
     <span class="p">(</span><span class="k">define </span><span class="nv">tolerance</span> <span class="mf">0.0001</span><span class="p">)</span>

     <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">tan-cf</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">pi</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">10</span><span class="p">)</span> <span class="nv">tan60</span><span class="p">))</span> <span class="nv">tolerance</span><span class="p">)</span> <span class="c1">;passed</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org5b79d55" class="outline-3">
<h3 id="org5b79d55">过程作为返回值</h3>
<div class="outline-text-3" id="text-org5b79d55">
<ol class="org-ol">
<li>创建一种其返回值本身也是过程的过程，能使程序设计语言得到进一步的表达能力；</li>
<li>将一个计算过程形式化为一个过程，一般来说存在很多不同的方式，有经验的程序
员知道如何选择过程的形式，使其特别地清晰且易理解，使该计算过程中有用的元
素能表现为一些相互分离的个体，并使它们还可能重新用于其他的应用；</li>
<li>复合过程作为一种至关重要的抽象机制，使我们能将一般性的计算方法明确描述为
这一程序设计语言中的的元素，高阶函数可以操作这些一般性的方法以便建立起进
一步的抽象；</li>
<li>编程者应该对第3条所述的可能性保持高度敏感，设法从中识别出程序里的基本抽象，
基于它们去进一步构造，并推广它们以创建威力更加强大的抽象。；</li>
<li>在工作中选择合适的抽象层次，但重要的是能基于这种抽象去思考；</li>
<li>高阶过程的重要性，在于使我们能显式地将这些抽象描述为程序设计语言的要素，
使我们能像操作其他计算要素一样去操作它们；</li>
<li>Lisp 给了过程完全的第一级状态（一等公民）。</li>
</ol>
</div>
</div>

<div id="outline-container-org73fbeb8" class="outline-3">
<h3 id="org73fbeb8">练习 1.40-1.46</h3>
<div class="outline-text-3" id="text-org73fbeb8">
</div>
<div id="outline-container-org06ae840" class="outline-4">
<h4 id="org06ae840">1.40</h4>
<div class="outline-text-4" id="text-org06ae840">
<div class="highlight"><pre><span></span>     <span class="c1">;; (load "./1.35.scm")</span>

     <span class="p">(</span><span class="k">define </span><span class="nv">dx</span> <span class="mf">0.00001</span><span class="p">)</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">deriv</span> <span class="nv">g</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">g</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">dx</span><span class="p">))</span> <span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">))</span>
	    <span class="nv">dx</span><span class="p">)))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">newton-transform</span> <span class="nv">g</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">- </span><span class="nv">x</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">)</span> <span class="p">((</span><span class="nf">deriv</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">newton-method</span> <span class="nv">g</span> <span class="nv">guess</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="nf">newton-transform</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">guess</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cubic</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">)</span>
	    <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">))</span>
	    <span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="nv">x</span><span class="p">)</span>
	    <span class="nv">c</span><span class="p">)))</span>

     <span class="p">(</span><span class="nf">newton-method</span> <span class="p">(</span><span class="nf">cubic</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>		<span class="c1">;-1.2756822...</span>
</pre></div>
</div>
</div>

<div id="outline-container-org68fa159" class="outline-4">
<h4 id="org68fa159">1.41</h4>
<div class="outline-text-4" id="text-org68fa159">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">double</span> <span class="nv">f</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">inc</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>

     <span class="p">(((</span><span class="nf">double</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">double</span><span class="p">))</span> <span class="nv">inc</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span>	<span class="c1">;21</span>
</pre></div>
</div>
</div>

<div id="outline-container-org19b479c" class="outline-4">
<h4 id="org19b479c">1.42</h4>
<div class="outline-text-4" id="text-org19b479c">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">inc</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">compose</span> <span class="nv">f1</span> <span class="nv">f2</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">f1</span> <span class="p">(</span><span class="nf">f2</span> <span class="nv">x</span><span class="p">))))</span>

     <span class="p">((</span><span class="nf">compose</span> <span class="nv">square</span> <span class="nv">inc</span><span class="p">)</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgb2e4c4c" class="outline-4">
<h4 id="orgb2e4c4c">1.43</h4>
<div class="outline-text-4" id="text-orgb2e4c4c">
<div class="highlight"><pre><span></span>     <span class="c1">;; (load "./1.42.scm")</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">repeated</span> <span class="nv">f</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
	   <span class="nv">f</span>
	   <span class="p">(</span><span class="nf">compose</span> <span class="nv">f</span> <span class="p">(</span><span class="nf">repeated</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>

     <span class="p">((</span><span class="nf">repeated</span> <span class="nv">square</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span>			<span class="c1">;625</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3d57ff9" class="outline-4">
<h4 id="org3d57ff9">1.44</h4>
<div class="outline-text-4" id="text-org3d57ff9">
<div class="highlight"><pre><span></span>     <span class="c1">;; (load "./1.42.scm")</span>
     <span class="c1">;; (load "./1.43.scm")</span>

     <span class="p">(</span><span class="k">define </span><span class="nv">dx</span> <span class="mf">0.00001</span><span class="p">)</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smooth</span> <span class="nv">f</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x</span> <span class="nv">dx</span><span class="p">))</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">dx</span><span class="p">)))</span> <span class="mi">3</span><span class="p">)))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smooth-n</span> <span class="nv">f</span> <span class="nv">n</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">repeated</span> <span class="nv">smooth</span>
		 <span class="nv">n</span><span class="p">)</span>
       <span class="nv">f</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org122f218" class="outline-4">
<h4 id="org122f218">1.45</h4>
<div class="outline-text-4" id="text-org122f218">
<div class="highlight"><pre><span></span>     <span class="c1">;; (load "./1.35.scm")</span>
     <span class="c1">;; (load "./1.43.scm")</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average-damp</span> <span class="nv">f</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">root</span> <span class="nv">n</span> <span class="nv">x</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">fixed-point</span>
	<span class="p">((</span><span class="nf">repeated</span>
	  <span class="nv">average-damp</span>
	  <span class="p">(</span><span class="nb">quotient </span><span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="p">(</span><span class="nb">expt </span><span class="nv">y</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
	<span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgec591e1" class="outline-4">
<h4 id="orgec591e1">1.46</h4>
<div class="outline-text-4" id="text-orgec591e1">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iterative-improve</span> <span class="nv">good-enough?</span> <span class="nv">improve</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">x</span><span class="p">)</span>
	     <span class="nv">x</span>
	     <span class="p">((</span><span class="nf">iterative-improve</span> <span class="nv">good-enough?</span> <span class="nv">improve</span><span class="p">)</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">x</span><span class="p">)))))</span>

     <span class="c1">;; sqrt</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">sqrt </span><span class="nv">x</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="nv">guess</span><span class="p">)))</span>

       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">square</span> <span class="nv">guess</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span>

       <span class="p">((</span><span class="nf">iterative-improve</span> <span class="nv">good-enough?</span> <span class="nv">improve</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">))</span>

     <span class="c1">;; fixed-point</span>

     <span class="p">(</span><span class="k">define </span><span class="nv">tolerance</span> <span class="mf">0.00001</span><span class="p">)</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span> <span class="nv">first-guess</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">guess</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">guess</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span> <span class="nv">tolerance</span><span class="p">))</span>

       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">))</span>

       <span class="p">((</span><span class="nf">iterative-improve</span> <span class="nv">close-enough?</span> <span class="nv">improve</span><span class="p">)</span> <span class="nv">first-guess</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
            
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="https-zero4drift-github-io",
            disqus_url="https://zero4drift.github.io/posts/sicp-refresher-chapter-1%283%29/",
        disqus_title="SICP-Refresher-Chapter-1(3)",
        disqus_identifier="cache/posts/sicp-refresher-chapter-1(3).html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        
    


        </div>
    </div>

    
    <footer><div class="container">
            <div class="social">



                <div class="social-entry">
                    <a href="../../rss.xml" target="_blank">
                        <i class="fa fa-rss"></i> 
                    </a>
                </div>
            </div>
                <div class="copyright">
                    Contents © 2019         <a href="mailto:fang0052@e.ntu.edu.sg">zero4drift</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
                    
                </div>
           
        </div>
    </footer><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?06e0ade16d98033ac1aad78106d873c8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script src="../../assets/js/all-nocdn.js" type="text/javascript"></script>
</body>
</html>
