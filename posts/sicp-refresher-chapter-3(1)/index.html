<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Refresher of SICP chapter 3.1 Modularity, Objects, and State 模块化，对象和状态">
<meta name="viewport" content="width=device-width">
<title>SICP-Refresher-Chapter-3(1) | 钉钉是世界上最傻逼的app</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://zero4drift.github.io/posts/sicp-refresher-chapter-3%281%29/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="zero4drift">
<meta property="og:site_name" content="钉钉是世界上最傻逼的app">
<meta property="og:title" content="SICP-Refresher-Chapter-3(1)">
<meta property="og:url" content="https://zero4drift.github.io/posts/sicp-refresher-chapter-3%281%29/">
<meta property="og:description" content="Refresher of SICP chapter 3.1 Modularity, Objects, and State 模块化，对象和状态">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-12-30T14:51:05+08:00">
<meta property="article:tag" content="Scheme">
<meta property="article:tag" content="SICP">
</head>
<body>
    

    <header id="header" class="navbar"><div class="container">
            
    <div class="brand">

        <div class="brand-text">
            <a href="https://zero4drift.github.io/" title="钉钉是世界上最傻逼的app" rel="home">
                钉钉是世界上最傻逼的app
            </a>
        </div>

        <a id="btn-toggle-nav" class="navbar-toggle">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
    </div>

            
    <nav class="navbar-collapse collapse"><ul class="nav">
<li><a href="../../archive.html">Archive</a></li>
                <li><a href="https://github.com/zero4drift">Github</a></li>
                <li><a href="../../categories/">Tags</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>
    
    
    </ul></nav>
</div>
    </header><div class="header-padding"> </div>

    
    <div class="post-header">
        <div class="container">
            <div class="title">
                SICP-Refresher-Chapter-3(1)
            </div>
        </div>
    </div>

    <div class="post-meta">
      <div class="container">
	<div class="meta clearfix">
	  <div class="authordate">
	    <time class="timeago" datetime="2018-12-30T14:51:05+08:00">2018/12/30</time>
</div>
	  <div class="post-tags">
	    <div class="tag">
	      <a href="../../categories/scheme/" rel="tag">Scheme</a>
	    </div>
	    <div class="tag">
	      <a href="../../categories/sicp/" rel="tag">SICP</a>
	    </div>
	  </div>
	</div>
      </div>
    </div>
    
    
    <div id="post-main" class="main">
        <div class="container">
        <div id="outline-container-org76bb13d" class="outline-2">
<h2 id="org76bb13d">第三章</h2>
<div class="outline-text-2" id="text-org76bb13d">
<ol class="org-ol">
<li>有效的程序综合需要一些组织原则，它们应能指导我们系统化地完成系统的整体设计，
特别是需要一些能帮助我们构造起模块化的大型系统的策略，也就是说，使这些系统
能够“自然地”划分为一些具有内聚力地部分，使这些部分可以分别进行开发和维护；</li>
<li>有一种非常强有力的设计策略，特别适合用于构造那类模拟真实物理系统的程序，那
就是基于被模拟系统的结构去设计程序的结构；这样在很大程度上组织大型程序的方
式会受到我们对于被模拟系统的认识的支配；</li>
<li>两种策略：
<ol class="org-ol">
<li>将注意力集中在对象上，将一个大型系统看成一大批对象，它们的行为可能随着时
间的进展而不断变化；
<ol class="org-ol">
<li>迫使我们抛弃老的计算的代换模形，转向更机械式的，理论上也更不容易把握
的环境模形；</li>
</ol>
</li>
<li>将注意力集中在流过系统的信息流上。
<ol class="org-ol">
<li>使用被称为延时求值的技术松解在我们的模形中对时间的模拟与计算机求值过
程中的各种事件发生的顺序；</li>
</ol>
</li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-orgdc4c8e7" class="outline-3">
<h3 id="orgdc4c8e7">赋值和局部状态</h3>
<div class="outline-text-3" id="text-orgdc4c8e7">
<ol class="org-ol">
<li>如果一个系统中的状态变量可以分组，形成一些内部紧密结合的子系统，每个子系统
与其他子系统之间只存在松散联系，此时将这个系统看作是由一些独立对象组成的观
点就会特别有用；</li>
<li>这种观点有可能成为组织这一系统的计算模形的有力框架：要使这样的一个模型成为
模块化的，就要求它能分解为一批计算对象，使它们能够模拟系统里的实际对象，每
一个简单对象必须有它自己的一些局部状态变量，用于描述实际对象的状态；</li>
</ol>
</div>

<div id="outline-container-org79f5ec4" class="outline-4">
<h4 id="org79f5ec4">局部状态变量</h4>
<div class="outline-text-4" id="text-org79f5ec4">
<ol class="org-ol">
<li>第三章引入赋值运算符之前， <i>SICP</i> 中所有过程可以看作一些可计算的数学函数
的描述，对一个过程的调用将计算出相应函数作用于给定参数应得到的值，用同样
的实际参数两次调用同一个过程，总会产生出相同的结果；</li>
<li>
<code>(set! &lt;name&gt; &lt;new-value&gt;)</code> &lt;name&gt; 应是一个符号，&lt;new-value&gt; 是任何表达式，
set! 将修改 &lt;name&gt;，使它的值变成求值 &lt;new-value&gt; 得到的结果；</li>
<li>
<code>(begin &lt;exp1&gt; &lt;exp2&gt; ... &lt;expk&gt;)</code> 将导致表达式 &lt;exp1&gt; 到 &lt;expk&gt; 按顺序求
值，最后一个表达式 &lt;expk&gt; 的值又将作为整个 begin 形式的值返回；</li>
</ol>
</div>
</div>

<div id="outline-container-orgdb7132c" class="outline-4">
<h4 id="orgdb7132c">练习 3.1-3.4</h4>
<div class="outline-text-4" id="text-orgdb7132c">
</div>
<ul class="org-ul">
<li>
<a id="org7d4f27c"></a>3.1<br><div class="outline-text-5" id="text-org7d4f27c">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-accumulator</span> <span class="nv">n</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">amount</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">n</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="nv">amount</span><span class="p">))</span>
		  <span class="nv">n</span><span class="p">)))</span>
</pre></div>
</div>
</li>

<li>
<a id="org4650613"></a>3.2<br><div class="outline-text-5" id="text-org4650613">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-monitored</span> <span class="nv">f</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">count</span> <span class="mi">0</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
	   <span class="p">(</span><span class="nf">cond</span>
	    <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="ss">'how-many-calls?</span><span class="p">)</span> <span class="nv">count</span><span class="p">)</span>
	    <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="ss">'reset-count</span><span class="p">)</span> <span class="p">(</span><span class="k">set! </span><span class="nv">count</span> <span class="mi">0</span><span class="p">))</span>
	    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">count</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">count</span> <span class="mi">1</span><span class="p">))</span>
			 <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)))))))</span>
</pre></div>
</div>
</li>

<li>
<a id="orgc512e21"></a>3.3<br><div class="outline-text-5" id="text-orgc512e21">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-account</span> <span class="nv">balance</span> <span class="nv">password</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">withdraw</span> <span class="nv">amount</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt;= </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">)</span>
	     <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">balance</span> <span class="p">(</span><span class="nb">- </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span>
		    <span class="nv">balance</span><span class="p">)</span>
	     <span class="s">"Insufficient funds"</span><span class="p">))</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">deposit</span> <span class="nv">amount</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">set! </span><span class="nv">balance</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span>
	 <span class="nv">balance</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">dispatch</span> <span class="nv">p</span> <span class="nv">m</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">p</span> <span class="nv">password</span><span class="p">)</span>
	     <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">eq? </span><span class="nv">m</span> <span class="ss">'withdraw</span><span class="p">)</span> <span class="nv">withdraw</span><span class="p">)</span>
		   <span class="p">((</span><span class="nb">eq? </span><span class="nv">m</span> <span class="ss">'deposit</span><span class="p">)</span> <span class="nv">deposit</span><span class="p">)</span>
		   <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown request -- MAKE-ACCOUNT"</span>
				<span class="nv">m</span><span class="p">)))</span>
	     <span class="p">(</span><span class="nf">error</span> <span class="s">"Incorrect password"</span><span class="p">)))</span>
       <span class="nv">dispatch</span><span class="p">)</span>
</pre></div>
</div>
</li>

<li>
<a id="orgd8ac474"></a>3.4<br><div class="outline-text-5" id="text-orgd8ac474">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-account</span> <span class="nv">balance</span> <span class="nv">password</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">call-the-cops</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">display </span><span class="s">"Cops on the way..."</span><span class="p">))</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">withdraw</span> <span class="nv">amount</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt;= </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">)</span>
	     <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">balance</span> <span class="p">(</span><span class="nb">- </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span>
		    <span class="nv">balance</span><span class="p">)</span>
	     <span class="s">"Insufficient funds"</span><span class="p">))</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">deposit</span> <span class="nv">amount</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">set! </span><span class="nv">balance</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span>
	 <span class="nv">balance</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">failure-entries</span> <span class="mi">0</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">dispatch</span> <span class="nv">p</span> <span class="nv">m</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">p</span> <span class="nv">password</span><span class="p">)</span>
	       <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">failure-entries</span> <span class="mi">0</span><span class="p">)</span>
		      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">eq? </span><span class="nv">m</span> <span class="ss">'withdraw</span><span class="p">)</span> <span class="nv">withdraw</span><span class="p">)</span>
			    <span class="p">((</span><span class="nb">eq? </span><span class="nv">m</span> <span class="ss">'deposit</span><span class="p">)</span> <span class="nv">deposit</span><span class="p">)</span>
			    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown request -- MAKE-ACCOUNT"</span>
					 <span class="nv">m</span><span class="p">))))</span>
	       <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">failure-entries</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="nv">failure-entries</span><span class="p">))</span>
		      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">failure-entries</span> <span class="mi">7</span><span class="p">)</span>
			  <span class="p">(</span><span class="nf">error</span> <span class="s">"Incorrect password"</span><span class="p">)</span>
			  <span class="p">(</span><span class="nf">call-the-cops</span><span class="p">)))))</span>
	 <span class="nv">dispatch</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div>

<div id="outline-container-org165e10b" class="outline-4">
<h4 id="org165e10b">引进赋值带来的收益</h4>
<div class="outline-text-4" id="text-org165e10b">
<ol class="org-ol">
<li>将赋值引进所用的程序设计语言，将会使我们陷入许多困难的概念问题的丛林中；</li>
<li>将系统看作是一集带有局部状态的独立对象，也是一种维护模块化设计的强有力技术；</li>
<li>与所有状态都必须显式地操作和传递额外参数的方式相比，通过引进赋值和将状态
隐藏在局部变量中的技术，我们能以一种更模块化的方式构造系统；</li>
</ol>
</div>
</div>

<div id="outline-container-orgf625ac2" class="outline-4">
<h4 id="orgf625ac2">练习 3.5-3.6</h4>
<div class="outline-text-4" id="text-orgf625ac2">
</div>
<ul class="org-ul">
<li>
<a id="org31d2b09"></a>3.5<br><div class="outline-text-5" id="text-org31d2b09">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">monte-carlo</span> <span class="nv">trials</span> <span class="nv">experiment</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">trials-remaining</span> <span class="nv">trials-passed</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">trials-remaining</span> <span class="mi">0</span><span class="p">)</span>
		<span class="p">(</span><span class="nb">/ </span><span class="nv">trials-passed</span> <span class="nv">trials</span><span class="p">))</span>
	       <span class="p">((</span><span class="nf">experiment</span><span class="p">)</span>
		<span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">- </span><span class="nv">trials-remaining</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">trials-passed</span> <span class="mi">1</span><span class="p">)))</span>
	       <span class="p">(</span><span class="nf">else</span>
		<span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">- </span><span class="nv">trials-remaining</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">trials-passed</span><span class="p">))))</span>
       <span class="p">(</span><span class="nf">iter</span> <span class="nv">trials</span> <span class="mi">0</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-point</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">x-point</span> <span class="nv">p</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">car </span><span class="nv">p</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">y-point</span> <span class="nv">p</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">mid-point</span> <span class="nv">p1</span> <span class="nv">p2</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">x</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">x-point</span> <span class="nv">p1</span><span class="p">)</span> <span class="p">(</span><span class="nf">x-point</span> <span class="nv">p2</span><span class="p">))</span> <span class="mi">2</span><span class="p">))</span>
	     <span class="p">(</span><span class="nf">y</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">y-point</span> <span class="nv">p1</span><span class="p">)</span> <span class="p">(</span><span class="nf">y-point</span> <span class="nv">p2</span><span class="p">))</span> <span class="mi">2</span><span class="p">)))</span>
	 <span class="p">(</span><span class="nf">make-point</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)))</span>

     <span class="c1">;; there the rectangular is just a square.</span>
     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">radius-square</span> <span class="nv">p1</span> <span class="nv">p2</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">x1</span> <span class="p">(</span><span class="nf">x-point</span> <span class="nv">p1</span><span class="p">))</span>
	     <span class="p">(</span><span class="nf">x2</span> <span class="p">(</span><span class="nf">x-point</span> <span class="nv">p2</span><span class="p">)))</span>
	 <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="nv">x1</span> <span class="nv">x2</span><span class="p">)</span> <span class="mi">2</span><span class="p">)))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">p</span> <span class="nv">r1</span> <span class="nv">r2</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">rs</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nb">- </span><span class="nv">r1</span> <span class="nv">m1</span><span class="p">))</span>
	      <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nb">- </span><span class="nv">r2</span> <span class="nv">m2</span><span class="p">)))</span>
	   <span class="nv">rs</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">random-in-range</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">range</span> <span class="p">(</span><span class="nb">- </span><span class="nv">high</span> <span class="nv">low</span><span class="p">)))</span>
	 <span class="p">(</span><span class="nb">+ </span><span class="nv">low</span> <span class="p">(</span><span class="nf">random</span> <span class="nv">range</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">estimate-integral</span> <span class="nv">p</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">y1</span> <span class="nv">y2</span> <span class="nv">n</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">p1</span> <span class="p">(</span><span class="nf">make-point</span> <span class="nv">x1</span> <span class="nv">y1</span><span class="p">))</span>
	     <span class="p">(</span><span class="nf">p2</span> <span class="p">(</span><span class="nf">make-point</span> <span class="nv">x2</span> <span class="nv">y2</span><span class="p">)))</span>
	 <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">center</span> <span class="p">(</span><span class="nf">mid-point</span> <span class="nv">p1</span> <span class="nv">p2</span><span class="p">)))</span>
	   <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">integral-test</span><span class="p">)</span>
	     <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">r1</span> <span class="p">(</span><span class="nf">random-in-range</span> <span class="nv">x1</span> <span class="nv">x2</span><span class="p">))</span>
		   <span class="p">(</span><span class="nf">r2</span> <span class="p">(</span><span class="nf">random-in-range</span> <span class="nv">y1</span> <span class="nv">y2</span><span class="p">))</span>
		   <span class="p">(</span><span class="nf">m1</span> <span class="p">(</span><span class="nf">x-point</span> <span class="nv">center</span><span class="p">))</span>
		   <span class="p">(</span><span class="nf">m2</span> <span class="p">(</span><span class="nf">y-point</span> <span class="nv">center</span><span class="p">))</span>
		   <span class="p">(</span><span class="nf">rs</span> <span class="p">(</span><span class="nf">radius-square</span> <span class="nv">p1</span> <span class="nv">p2</span><span class="p">)))</span>
	       <span class="p">(</span><span class="nf">p</span> <span class="nv">r1</span> <span class="nv">r2</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">rs</span><span class="p">)))</span>
	   <span class="p">(</span><span class="nf">monte-carlo</span> <span class="nv">n</span> <span class="nv">integral-test</span><span class="p">))))</span>

     <span class="p">(</span><span class="nf">estimate-integral</span> <span class="nv">p</span> <span class="mf">2.0</span> <span class="mf">8.0</span> <span class="mf">4.0</span> <span class="mf">10.0</span> <span class="mi">100000</span><span class="p">)</span> <span class="c1">;393/500</span>
</pre></div>
</div>
</li>

<li>
<a id="org0121a7e"></a>3.6<br><div class="outline-text-5" id="text-org0121a7e">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="nv">rand</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">x</span> <span class="nv">random-init</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">generate</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">x</span> <span class="p">(</span><span class="nf">rand-update</span> <span class="nv">x</span><span class="p">))</span>
		  <span class="nv">x</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">reset</span> <span class="nv">n</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">set! </span><span class="nv">x</span> <span class="nv">n</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">dispatch</span> <span class="nv">s</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">eq? </span><span class="nv">s</span> <span class="ss">'generate</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">generate</span><span class="p">))</span>
		 <span class="p">((</span><span class="nb">eq? </span><span class="nv">s</span> <span class="ss">'reset</span><span class="p">)</span>
		  <span class="nv">reset</span><span class="p">)</span>
		 <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown request -- RAND"</span>
			      <span class="nv">s</span><span class="p">))))</span>
	 <span class="nv">dispatch</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgeb3039e" class="outline-4">
<h4 id="orgeb3039e">引进赋值的代价</h4>
<div class="outline-text-4" id="text-orgeb3039e">
<ol class="org-ol">
<li>不用任何赋值的程序设计称为函数式程序设计；</li>
<li>本质上讲，代换的最终基础就是，这一语言里的符号不过是作为值的名字；而一旦
引进了 set! 和变量的值可以变化的想法，一个变量就不再是一个简单的名字，变
量索引着一个可以保存值的位置，而存储在那里的值也是可以改变的；</li>
<li>如果一个语言支持在表达式里“同一的东西可以相互替换”的观念，这样的替换不会
改变有关表达式的值；这个语言就称为具有引用透明性，在我们的计算机语言里包
含了 set! 之后，也就打破了引用透明性，这使确定能否通过等价的表达式代换去
简化表达式变成了一个异常错综复杂的问题了；</li>
<li>广泛采用赋值的程序设计被称为命令式程序设计；</li>
<li>带有赋值的程序将强迫人们去考虑赋值的相对顺序，以保证每个语句所用的的是被
修改变量的正确版本；在函数式程序设计中，这类问题根本就不会出现；如果考虑
有着多个并发执行的进程的应用程序，命令式程序设计的复杂性还会变得更糟糕；</li>
</ol>
</div>
</div>

<div id="outline-container-org6c1a3ac" class="outline-4">
<h4 id="org6c1a3ac">练习 3.7-3.8</h4>
<div class="outline-text-4" id="text-org6c1a3ac">
</div>
<ul class="org-ul">
<li>
<a id="orgbb772a9"></a>3.7<br><div class="outline-text-5" id="text-orgbb772a9">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-account</span> <span class="nv">balance</span> <span class="nv">pass</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">password</span> <span class="p">(</span><span class="nb">list </span><span class="nv">pass</span><span class="p">)))</span>
	 <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">withdraw</span> <span class="nv">amount</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt;= </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">)</span>
	       <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">balance</span> <span class="p">(</span><span class="nb">- </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span>
		      <span class="nv">balance</span><span class="p">)</span>
	       <span class="s">"Insufficient funds"</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">deposit</span> <span class="nv">amount</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">balance</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span>
		  <span class="nv">balance</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">joint</span> <span class="nv">new-password</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">password</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new-password</span> <span class="nv">password</span><span class="p">))</span>
		  <span class="nv">dispatch</span><span class="p">))</span>
	 <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">dispatch</span> <span class="nv">p</span> <span class="nv">m</span><span class="p">)</span>
	   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">memq </span><span class="nv">p</span> <span class="nv">password</span><span class="p">)</span>
	       <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">eq? </span><span class="nv">m</span> <span class="ss">'withdraw</span><span class="p">)</span> <span class="nv">withdraw</span><span class="p">)</span>
		     <span class="p">((</span><span class="nb">eq? </span><span class="nv">m</span> <span class="ss">'deposit</span><span class="p">)</span> <span class="nv">deposit</span><span class="p">)</span>
		     <span class="p">((</span><span class="nb">eq? </span><span class="nv">m</span> <span class="ss">'joint</span><span class="p">)</span> <span class="nv">joint</span><span class="p">)</span>
		     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown request -- MAKE-ACCOUNT"</span>
				  <span class="nv">m</span><span class="p">)))</span>
	       <span class="p">(</span><span class="nf">error</span> <span class="s">"Incorrect password"</span><span class="p">)))</span>
	 <span class="nv">dispatch</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-joint</span>  <span class="nv">acc</span> <span class="nv">old-pass</span> <span class="nv">new-pass</span><span class="p">)</span>
       <span class="p">((</span><span class="nf">acc</span> <span class="nv">old-pass</span> <span class="ss">'joint</span><span class="p">)</span> <span class="nv">new-pass</span><span class="p">))</span>
</pre></div>
</div>
</li>

<li>
<a id="org17b95c7"></a>3.8<br><div class="outline-text-5" id="text-org17b95c7">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">g</span> <span class="nv">y</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">z</span> <span class="nv">y</span><span class="p">))</span>
	   <span class="p">(</span><span class="k">set! </span><span class="nv">y</span> <span class="nv">x</span><span class="p">)</span>
	   <span class="nv">z</span><span class="p">))</span>
       <span class="nv">f</span><span class="p">)</span>

     <span class="p">(</span><span class="k">define </span><span class="nv">f</span> <span class="p">(</span><span class="nf">g</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>
            
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="https-zero4drift-github-io",
            disqus_url="https://zero4drift.github.io/posts/sicp-refresher-chapter-3%281%29/",
        disqus_title="SICP-Refresher-Chapter-3(1)",
        disqus_identifier="cache/posts/sicp-refresher-chapter-3(1).html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        
    


        </div>
    </div>

    
    <footer><div class="container">
            <div class="social">



                <div class="social-entry">
                    <a href="../../rss.xml" target="_blank">
                        <i class="fa fa-rss"></i> 
                    </a>
                </div>
            </div>
                <div class="copyright">
                    Contents © 2019         <a href="mailto:fang0052@e.ntu.edu.sg">zero4drift</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
                    
                </div>
           
        </div>
    </footer><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?06e0ade16d98033ac1aad78106d873c8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script src="../../assets/js/all-nocdn.js" type="text/javascript"></script>
</body>
</html>
