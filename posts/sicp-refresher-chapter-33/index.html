<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>SICP-Refresher-Chapter-3(3) - 找一个吃麦旋风的理由</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="zero4drift" />
  <meta name="description" content="用变动数据做模拟 为了模拟那些由具有不断变化的状态组成的系统，我们除了需要做复合数据对象的构 造和成员选择之外，还可能需要修改它们； 为了模拟具有" />

  <meta name="keywords" content="代码, 算法, 工具" />






<meta name="generator" content="Hugo 0.48" />


<link rel="canonical" href="https://zero4drift.github.io/posts/sicp-refresher-chapter-33/" />



<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.28854364c052ec02eba4ee5867bc889d3a567cdf337ba3a355c33511d20bee1e.css" integrity="sha256-KIVDZMBS7ALrpO5YZ7yInTpWfN8ze6OjVcM1EdIL7h4=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="SICP-Refresher-Chapter-3(3)" />
<meta property="og:description" content="用变动数据做模拟 为了模拟那些由具有不断变化的状态组成的系统，我们除了需要做复合数据对象的构 造和成员选择之外，还可能需要修改它们； 为了模拟具有" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zero4drift.github.io/posts/sicp-refresher-chapter-33/" /><meta property="article:published_time" content="2019-01-01T13:45:00&#43;08:00"/>
<meta property="article:modified_time" content="2019-01-14T22:23:19&#43;08:00"/>
<meta itemprop="name" content="SICP-Refresher-Chapter-3(3)">
<meta itemprop="description" content="用变动数据做模拟 为了模拟那些由具有不断变化的状态组成的系统，我们除了需要做复合数据对象的构 造和成员选择之外，还可能需要修改它们； 为了模拟具有">


<meta itemprop="datePublished" content="2019-01-01T13:45:00&#43;08:00" />
<meta itemprop="dateModified" content="2019-01-01T13:45:00&#43;08:00" />
<meta itemprop="wordCount" content="4256">



<meta itemprop="keywords" content="SICP,Scheme," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SICP-Refresher-Chapter-3(3)"/>
<meta name="twitter:description" content="用变动数据做模拟 为了模拟那些由具有不断变化的状态组成的系统，我们除了需要做复合数据对象的构 造和成员选择之外，还可能需要修改它们； 为了模拟具有"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-112733609-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">找一个吃麦旋风的理由</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://zero4drift.github.io/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://zero4drift.github.io/post/">存档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://zero4drift.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://zero4drift.github.io/categories/">分类</a>
          
        
      </li>
    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      找一个吃麦旋风的理由
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://zero4drift.github.io/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://zero4drift.github.io/post/">存档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://zero4drift.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://zero4drift.github.io/categories/">分类</a>
          

        

      </li>
    
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">SICP-Refresher-Chapter-3(3)</h1>
      
      <div class="post-meta">
        <time datetime="2019-01-01" class="post-time">
          2019-01-01
        </time>
        <div class="post-category">
            <a href="https://zero4drift.github.io/categories/sicp/"> SICP </a>
            
          </div>
        

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#用变动数据做模拟">用变动数据做模拟</a>
<ul>
<li><a href="#变动的表结构">变动的表结构</a></li>
<li><a href="#练习-3-dot-12-3-dot-20">练习 3.12-3.20</a>
<ul>
<li><a href="#3-dot-12">3.12</a></li>
<li><a href="#3-dot-13">3.13</a></li>
<li><a href="#3-dot-14">3.14</a></li>
<li><a href="#3-dot-15">3.15</a></li>
<li><a href="#3-dot-16">3.16</a></li>
<li><a href="#3-dot-17">3.17</a></li>
<li><a href="#3-dot-18">3.18</a></li>
<li><a href="#3-dot-19">3.19</a></li>
<li><a href="#3-dot-20">3.20</a></li>
</ul></li>
<li><a href="#队列的表示">队列的表示</a></li>
<li><a href="#练习-3-dot-21-3-dot-23">练习 3.21-3.23</a>
<ul>
<li><a href="#3-dot-21">3.21</a></li>
<li><a href="#3-dot-22">3.22</a></li>
<li><a href="#3-dot-23">3.23</a></li>
</ul></li>
<li><a href="#表格的表示">表格的表示</a></li>
<li><a href="#练习-3-dot-24-3-dot-27">练习 3.24-3.27</a>
<ul>
<li><a href="#3-dot-24">3.24</a></li>
<li><a href="#3-dot-25">3.25</a></li>
<li><a href="#3-dot-26">3.26</a></li>
<li><a href="#3-dot-27">3.27</a></li>
</ul></li>
<li><a href="#数字电路的模拟器">数字电路的模拟器</a></li>
<li><a href="#练习-3-dot-28-3-dot-32">练习 3.28-3.32</a>
<ul>
<li><a href="#3-dot-28">3.28</a></li>
<li><a href="#3-dot-29">3.29</a></li>
<li><a href="#3-dot-30">3.30</a></li>
<li><a href="#3-dot-31">3.31</a></li>
<li><a href="#3-dot-32">3.32</a></li>
</ul></li>
<li><a href="#约束的传播">约束的传播</a></li>
<li><a href="#练习-3-dot-33-3-dot-37">练习 3.33-3.37</a>
<ul>
<li><a href="#3-dot-33">3.33</a></li>
<li><a href="#3-dot-34">3.34</a></li>
<li><a href="#3-dot-35">3.35</a></li>
<li><a href="#3-dot-36">3.36</a></li>
<li><a href="#3-dot-37">3.37</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h2 id="用变动数据做模拟">用变动数据做模拟</h2>

<ol>
<li>为了模拟那些由具有不断变化的状态组成的系统，我们除了需要做复合数据对象的构
造和成员选择之外，还可能需要修改它们；</li>
<li>为了模拟具有不断变化的状态的复合对象，我们将设计出与之对应的数据抽象，使其
中不但包含了选择函数和构造函数，还有包含一些称为 <strong>改变函数</strong> 的操作，这种操
作能够修改有关的数据对象；</li>
<li>定义了改变函数的数据对象称为 <strong>变动数据对象</strong>;</li>
</ol>

<h3 id="变动的表结构">变动的表结构</h3>

<ol>
<li>针对序对的基本改变函数使 <code>set-car!</code> 和 <code>set-cdr!</code>, <code>set-car!</code> 要求两个参
数，其中的第一个参数必须是一个序对， <code>set-car!</code> 修改这个序对，将它的 car
指针替换为指向 <code>set-car!</code> 的第二个参数的指针；</li>
<li><code>set-cdr!</code> 操作与 <code>set-car!</code> 类似，它们之间的差异就在于这里被取代的是序对
的 cdr 指针，而不是 car 指针；</li>
<li><code>cons</code> 通过 <strong>创建新序对</strong> 的方式构造新的表，而 <code>set-car!</code> 和 <code>set-cdr!</code> 则
是修改现存的序对；</li>
<li>一般而言，用 cons 构造出的表结构总是序对的一个相互链接的结构，其中可能会
有许多独立的序对被一些不同结构所共享；</li>
<li>如果只要 <code>cons car cdr</code> 对各种表进行操作，其中的共享就 <strong>完全不会被察觉</strong>,
然而，如果允许改变表结构的话，共享的情况就会显现出来了；</li>
<li>谓词 <code>(eq? x y)</code> 实际上检查 x 和 y 是否为同一个对象（也就是数，x 和 y 作
为指针是否相等）；</li>
<li>利用共享结构可以极大地扩展能够用于序对表示地数据结构的范围，另一方面，共
享也可能带来危险，因为对这种结构的修改将会影响那些恰好共享着被修改了的序
对的结构；</li>
<li>从理论上来说，为了表现变动数据的行为，所需要的全部东西也就是赋值；</li>
</ol>

<h3 id="练习-3-dot-12-3-dot-20">练习 3.12-3.20</h3>

<h4 id="3-dot-12">3.12</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 画图就省了；</span>
<span class="c1">;; 使用 append:</span>
<span class="c1">;; (cdr x): (list &#39;b)</span>

<span class="c1">;; 使用 append!:</span>
<span class="c1">;; (cdr x): (list &#39;b &#39;c &#39;d)</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-13">3.13</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-cycle</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">set-cdr!</span> <span class="p">(</span><span class="nv">last-pair</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">)</span>
  <span class="nv">x</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="nv">z</span> <span class="p">(</span><span class="nv">make-cycle</span> <span class="p">(</span><span class="nv">list</span> <span class="ss">&#39;a</span> <span class="ss">&#39;b</span> <span class="ss">&#39;c</span> <span class="ss">&#39;d</span><span class="p">)))</span>

<span class="c1">;; z: (list &#39;a &#39;b &#39;c &#39;d &#39;a &#39;b &#39;c &#39;d ....) deathloop!</span>

<span class="c1">;; (last-pair z): deathloop too</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-14">3.14</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 翻转</span>
<span class="c1">;; v: (list &#39;a &#39;b &#39;c &#39;d)</span>

<span class="c1">;; 最后打印</span>
<span class="c1">;; w: (list &#39;d &#39;c &#39;b &#39;a)</span>
<span class="c1">;; v: (list &#39;a)</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-15">3.15</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 很简单，画图就省了。</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-16">3.16</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 利用共享结构可以很容易地构造出复合需求地表结构；</span>

<span class="c1">;; 而使过程根本就不返回就是使序对的 car 部分或者 cdr 部分指向序对自己，过程执行</span>
<span class="c1">;; 将会进入无限递归，解释器报错 exceeds maximum recursion depth。</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-17">3.17</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 使用谓词 eq? 分辨前后遇到的序对是否是同一个序对</span>
<span class="c1">;; 过程 memq 主要基于谓词 eq?</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">count-pairs</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">checked</span> <span class="o">&#39;</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">recursive</span> <span class="nv">x</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">memq</span> <span class="nv">x</span> <span class="nv">checked</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">not</span> <span class="p">(</span><span class="nv">pair?</span> <span class="nv">x</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
	    <span class="p">(</span><span class="nv">else</span>
	     <span class="p">(</span><span class="nv">begin</span>
	       <span class="p">(</span><span class="k">set! </span><span class="nv">checked</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">x</span> <span class="nv">checked</span><span class="p">))</span>
	       <span class="p">(</span><span class="nv">+</span> <span class="p">(</span><span class="nv">recursive</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">x</span><span class="p">))</span>
		  <span class="p">(</span><span class="nv">recursive</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">x</span><span class="p">))</span>
		  <span class="mi">1</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nv">recursive</span> <span class="nv">x</span><span class="p">)))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-18">3.18</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">infinite?</span> <span class="nv">l</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">checked</span> <span class="o">&#39;</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">recursive</span> <span class="nv">x</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">null?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">memq</span> <span class="nv">x</span> <span class="nv">checked</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
	    <span class="p">(</span><span class="nv">else</span>
	     <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="k">set! </span><span class="nv">checked</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">x</span> <span class="nv">checked</span><span class="p">))</span>
		    <span class="p">(</span><span class="nv">recursive</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">x</span><span class="p">))))))</span>
    <span class="p">(</span><span class="nv">recursive</span> <span class="nv">l</span><span class="p">)))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-19">3.19</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 不是很明白这个算法的原理</span>
<span class="c1">;; 详情请参考 http://en.wikipedia.org/wiki/Cycle_detection</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">contains-cycle?</span> <span class="nv">lst</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">safe-cdr</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">pair?</span> <span class="nv">l</span><span class="p">)</span>
	<span class="p">(</span><span class="nv">cdr</span> <span class="nv">l</span><span class="p">)</span>
	<span class="o">&#39;</span><span class="p">()))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">iter</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">not</span> <span class="p">(</span><span class="nv">pair?</span> <span class="nv">a</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
	  <span class="p">((</span><span class="nv">not</span> <span class="p">(</span><span class="nv">pair?</span> <span class="nv">b</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
	  <span class="p">((</span><span class="nv">eq?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
	  <span class="p">((</span><span class="nv">eq?</span> <span class="nv">a</span> <span class="p">(</span><span class="nv">safe-cdr</span> <span class="nv">b</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
	  <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nv">iter</span> <span class="p">(</span><span class="nv">safe-cdr</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nv">safe-cdr</span> <span class="p">(</span><span class="nv">safe-cdr</span> <span class="nv">b</span><span class="p">))))))</span>
  <span class="p">(</span><span class="nv">iter</span> <span class="p">(</span><span class="nv">safe-cdr</span> <span class="nv">lst</span><span class="p">)</span> <span class="p">(</span><span class="nv">safe-cdr</span> <span class="p">(</span><span class="nv">safe-cdr</span> <span class="nv">lst</span><span class="p">))))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-20">3.20</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 虽然有点复杂，只是繁琐并不难，画图就省了。</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="队列的表示">队列的表示</h3>

<ol>
<li>将队列表示为一个序对，car 部分和 cdr 部分分别指向一个常规表中的第一个序对
和最后一个序对，这样的设计使队列操作都只需要 theta(1) 步就能完成；</li>
</ol>

<h3 id="练习-3-dot-21-3-dot-23">练习 3.21-3.23</h3>

<h4 id="3-dot-21">3.21</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 因为过程 delete-queue! 只修改一个队列表示的 front-ptr 部分</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">print-queue</span> <span class="nv">q</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">display</span>
   <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">q</span><span class="p">)))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-22">3.22</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-queue</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">front-ptr</span> <span class="o">&#39;</span><span class="p">())</span>
	<span class="p">(</span><span class="nv">rear-ptr</span> <span class="o">&#39;</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">empty-queue?</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">null?</span> <span class="nv">front-ptr</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">front-queue</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">empty-queue?</span><span class="p">)</span>
	  <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;FRONT called with an empty queue&#34;</span><span class="p">)</span>
	  <span class="p">(</span><span class="nv">car</span> <span class="nv">front-ptr</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">insert-queue!</span> <span class="nv">item</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">new-pair</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">item</span> <span class="o">&#39;</span><span class="p">())))</span>
	<span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">empty-queue?</span><span class="p">)</span>
	       <span class="p">(</span><span class="k">set! </span><span class="nv">front-ptr</span> <span class="nv">new-pair</span><span class="p">)</span>
	       <span class="p">(</span><span class="k">set! </span><span class="nv">rear-ptr</span> <span class="nv">new-pair</span><span class="p">)</span>
	       <span class="nv">front-ptr</span><span class="p">)</span>
	      <span class="p">(</span><span class="nv">else</span>
	       <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">rear-ptr</span> <span class="nv">new-pair</span><span class="p">)</span>
	       <span class="p">(</span><span class="k">set! </span><span class="nv">rear-ptr</span> <span class="nv">new-pair</span><span class="p">)</span>
	       <span class="nv">front-ptr</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">delete-queue!</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">empty-queue?</span><span class="p">)</span>
	     <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;DELETE! called with an empty queue&#34;</span><span class="p">))</span>
	    <span class="p">(</span><span class="nv">else</span>
	     <span class="p">(</span><span class="k">set! </span><span class="nv">front-ptr</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">front-ptr</span><span class="p">))</span>
	     <span class="nv">front-ptr</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">dispatch</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;empty-queue?</span><span class="p">)</span> <span class="nv">empty-queue?</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;front-queue</span><span class="p">)</span> <span class="nv">front-queue</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;insert-queue!</span><span class="p">)</span> <span class="nv">insert-queue!</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;delete-queue!</span><span class="p">)</span> <span class="nv">delete-queue!</span><span class="p">)))</span>
    <span class="nv">dispatch</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">empty-queue?</span> <span class="nv">queue</span><span class="p">)</span>
  <span class="p">((</span><span class="nv">queue</span> <span class="ss">&#39;empty-queue?</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">front-queue</span> <span class="nv">queue</span><span class="p">)</span>
  <span class="p">((</span><span class="nv">queue</span> <span class="ss">&#39;front-queue</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">insert-queue!</span> <span class="nv">queue</span> <span class="nv">item</span><span class="p">)</span>
  <span class="p">((</span><span class="nv">queue</span> <span class="ss">&#39;insert-queue!</span><span class="p">)</span> <span class="nv">item</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">delete-queue!</span> <span class="nv">queue</span><span class="p">)</span>
  <span class="p">((</span><span class="nv">queue</span> <span class="ss">&#39;delete-queue!</span><span class="p">)))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-23">3.23</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-deque</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">cons</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">()))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">car</span> <span class="nv">deque</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">rear-ptr</span> <span class="nv">deque</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">cdr</span> <span class="nv">deque</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">set-front-ptr!</span> <span class="nv">deque</span> <span class="nv">item</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">set-car!</span> <span class="nv">deque</span> <span class="nv">item</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">set-rear-ptr!</span> <span class="nv">deque</span> <span class="nv">item</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">deque</span> <span class="nv">item</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">empty-deque?</span> <span class="nv">deque</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">null?</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">front-deque</span> <span class="nv">deque</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">empty-deque?</span> <span class="nv">deque</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;FRONT called with an empty deque&#34;</span>
	     <span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">car</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">rear-deque</span> <span class="nv">deque</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">empty-deque?</span> <span class="nv">deque</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;FRONT called with an empty deque&#34;</span>
	     <span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">car</span> <span class="p">(</span><span class="nv">rear-ptr</span> <span class="nv">deque</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-pair</span> <span class="nv">item</span> <span class="nv">front</span> <span class="nv">rear</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">cons</span> <span class="nv">item</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">front</span> <span class="nv">rear</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">front-rear-pair</span> <span class="nv">pair</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">cdr</span> <span class="nv">pair</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">set-pair-front</span> <span class="nv">pair</span> <span class="nv">front</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">set-car!</span> <span class="p">(</span><span class="nv">front-rear-pair</span> <span class="nv">pair</span><span class="p">)</span> <span class="nv">front</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">set-pair-rear</span> <span class="nv">pair</span> <span class="nv">rear</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">set-cdr!</span> <span class="p">(</span><span class="nv">front-rear-pair</span> <span class="nv">pair</span><span class="p">)</span> <span class="nv">rear</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">pair-item</span> <span class="nv">pair</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">car</span> <span class="nv">pair</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">pair-rear</span> <span class="nv">pair</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">cdr</span> <span class="p">(</span><span class="nv">front-rear-pair</span> <span class="nv">pair</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">pair-front</span> <span class="nv">pair</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">car</span> <span class="p">(</span><span class="nv">front-rear-pair</span> <span class="nv">pair</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">front-insert-deque!</span> <span class="nv">deque</span> <span class="nv">item</span><span class="p">)</span> <span class="c1">;insert to the front</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">new-pair</span> <span class="p">(</span><span class="nv">make-pair</span> <span class="nv">item</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">())))</span>
    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">empty-deque?</span> <span class="nv">deque</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">set-front-ptr!</span> <span class="nv">deque</span> <span class="nv">new-pair</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">set-rear-ptr!</span> <span class="nv">deque</span> <span class="nv">new-pair</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">))</span>
	  <span class="p">(</span><span class="nv">else</span>
	   <span class="p">(</span><span class="nv">set-pair-front</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">)</span> <span class="nv">new-pair</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">set-pair-rear</span> <span class="nv">new-pair</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">))</span>
	   <span class="p">(</span><span class="nv">set-front-ptr!</span> <span class="nv">deque</span> <span class="nv">new-pair</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">rear-insert-deque!</span> <span class="nv">deque</span> <span class="nv">item</span><span class="p">)</span>	<span class="c1">;insert to the end</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">new-pair</span> <span class="p">(</span><span class="nv">make-pair</span> <span class="nv">item</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">())))</span>
    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">empty-deque?</span>
	    <span class="nv">deque</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">set-rear-ptr!</span> <span class="nv">deque</span> <span class="nv">new-pair</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">set-front-ptr!</span> <span class="nv">deque</span> <span class="nv">new-pair</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">))</span>
	  <span class="p">(</span><span class="nv">else</span>
	   <span class="p">(</span><span class="nv">set-pair-rear</span> <span class="p">(</span><span class="nv">rear-ptr</span> <span class="nv">deque</span><span class="p">)</span> <span class="nv">new-pair</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">set-pair-front</span> <span class="nv">new-pair</span> <span class="p">(</span><span class="nv">rear-ptr</span> <span class="nv">deque</span><span class="p">))</span>
	   <span class="p">(</span><span class="nv">set-rear-ptr!</span> <span class="nv">deque</span> <span class="nv">new-pair</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">front-delete-deque!</span> <span class="nv">deque</span><span class="p">)</span>	<span class="c1">;delete the front one</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">empty-deque?</span> <span class="nv">deque</span><span class="p">)</span>
	 <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;DELETE! called with an empty deque&#34;</span>
		<span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">)))</span>
	<span class="p">(</span><span class="nv">else</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">eq?</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">)</span> <span class="p">(</span><span class="nv">rear-ptr</span> <span class="nv">deque</span><span class="p">))</span>
	     <span class="p">(</span><span class="nv">begin</span>
	       <span class="p">(</span><span class="nv">set-front-ptr!</span> <span class="nv">deque</span> <span class="o">&#39;</span><span class="p">())</span>
	       <span class="p">(</span><span class="nv">set-rear-ptr!</span> <span class="nv">deque</span> <span class="o">&#39;</span><span class="p">()))</span>
	     <span class="p">(</span><span class="nv">begin</span>
	       <span class="p">(</span><span class="nv">set-front-ptr!</span> <span class="nv">deque</span> <span class="p">(</span><span class="nv">pair-rear</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">)))</span>
	       <span class="p">(</span><span class="nv">set-pair-front</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())))</span>
	 <span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">rear-delete-deque!</span> <span class="nv">deque</span><span class="p">)</span>	<span class="c1">;delete the rear one</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">empty-deque?</span> <span class="nv">deque</span><span class="p">)</span>
	 <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;DELETE! called with an empty deque&#34;</span>
		<span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">)))</span>
	<span class="p">(</span><span class="nv">else</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">eq?</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">)</span> <span class="p">(</span><span class="nv">rear-ptr</span> <span class="nv">deque</span><span class="p">))</span>
	     <span class="p">(</span><span class="nv">begin</span>
	       <span class="p">(</span><span class="nv">set-front-ptr!</span> <span class="nv">deque</span> <span class="o">&#39;</span><span class="p">())</span>
	       <span class="p">(</span><span class="nv">set-rear-ptr!</span> <span class="nv">deque</span> <span class="o">&#39;</span><span class="p">()))</span>
	     <span class="p">(</span><span class="nv">begin</span>
	       <span class="p">(</span><span class="nv">set-rear-ptr!</span> <span class="nv">deque</span> <span class="p">(</span><span class="nv">pair-front</span> <span class="p">(</span><span class="nv">rear-ptr</span> <span class="nv">deque</span><span class="p">)))</span>
	       <span class="p">(</span><span class="nv">set-pair-rear</span> <span class="p">(</span><span class="nv">rear-ptr</span> <span class="nv">deque</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())))</span>
	 <span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">display-deque</span> <span class="nv">deque</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">fetch-item</span> <span class="nv">ptr</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">null?</span> <span class="nv">ptr</span><span class="p">)</span>
	<span class="o">&#39;</span><span class="p">()</span>
	<span class="p">(</span><span class="nv">cons</span> <span class="p">(</span><span class="nv">pair-item</span> <span class="nv">ptr</span><span class="p">)</span>
	      <span class="p">(</span><span class="nv">fetch-item</span> <span class="p">(</span><span class="nv">pair-rear</span> <span class="nv">ptr</span><span class="p">)))))</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">not</span> <span class="p">(</span><span class="nv">empty-deque?</span> <span class="nv">deque</span><span class="p">))</span>
      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">front</span> <span class="p">(</span><span class="nv">front-ptr</span> <span class="nv">deque</span><span class="p">)))</span>
	<span class="p">(</span><span class="nv">fetch-item</span> <span class="nv">front</span><span class="p">))</span>
      <span class="o">&#39;</span><span class="p">()))</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="表格的表示">表格的表示</h3>

<ol>
<li>一维表格，二维表格及使用消息传递风格创建局部表格；</li>
</ol>

<h3 id="练习-3-dot-24-3-dot-27">练习 3.24-3.27</h3>

<h4 id="3-dot-24">3.24</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-table</span> <span class="nv">same-key?</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">local-table</span> <span class="p">(</span><span class="nv">list</span> <span class="ss">&#39;*table*</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">lookup</span> <span class="nv">key-1</span> <span class="nv">key-2</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">subtable</span> <span class="p">(</span><span class="nv">assoc</span> <span class="nv">key-1</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">local-table</span><span class="p">))))</span>
	<span class="p">(</span><span class="k">if </span><span class="nv">subtable</span>
	    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">record</span> <span class="p">(</span><span class="nv">assoc</span> <span class="nv">key-2</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">subtable</span><span class="p">))))</span>
	      <span class="p">(</span><span class="k">if </span><span class="nv">record</span>
		  <span class="p">(</span><span class="nv">cdr</span> <span class="nv">record</span><span class="p">)</span>
		  <span class="no">#f</span><span class="p">))</span>
	    <span class="no">#f</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">insert!</span> <span class="nv">key-1</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">subtable</span> <span class="p">(</span><span class="nv">assoc</span> <span class="nv">key-1</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">local-table</span><span class="p">))))</span>
	<span class="p">(</span><span class="k">if </span><span class="nv">subtable</span>
	    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">record</span> <span class="p">(</span><span class="nv">assoc</span> <span class="nv">key-2</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">subtable</span><span class="p">))))</span>
	      <span class="p">(</span><span class="k">if </span><span class="nv">record</span>
		  <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">record</span> <span class="nv">value</span><span class="p">)</span>
		  <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">subtable</span>
			    <span class="p">(</span><span class="nv">cons</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">)</span>
				  <span class="p">(</span><span class="nv">cdr</span> <span class="nv">subtable</span><span class="p">)))))</span>
	    <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">local-table</span>
		      <span class="p">(</span><span class="nv">cons</span> <span class="p">(</span><span class="nv">list</span> <span class="nv">key-1</span>
				  <span class="p">(</span><span class="nv">cons</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">))</span>
			    <span class="p">(</span><span class="nv">cdr</span> <span class="nv">local-table</span><span class="p">)))))</span>
      <span class="ss">&#39;ok</span><span class="p">)</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">assoc</span> <span class="nv">key</span> <span class="nv">records</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">null?</span> <span class="nv">records</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">same-key?</span> <span class="nv">key</span> <span class="p">(</span><span class="nv">caar</span> <span class="nv">records</span><span class="p">))</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">records</span><span class="p">))</span>
	    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nv">assoc</span> <span class="nv">key</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">records</span><span class="p">)))))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">dispatch</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;lookup-proc</span><span class="p">)</span> <span class="nv">lookup</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;insert-proc!</span><span class="p">)</span> <span class="nv">insert!</span><span class="p">)</span>
	    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nv">error</span> <span class="s">&#34;Unknown operation -- TABLE&#34;</span> <span class="nv">m</span><span class="p">))))</span>
    <span class="nv">dispatch</span><span class="p">))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-25">3.25</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-table</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">local-table</span> <span class="p">(</span><span class="nv">list</span> <span class="ss">&#39;*table*</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">lookup</span> <span class="nv">keys</span><span class="p">)</span>
      <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">recursive</span> <span class="nv">keys</span> <span class="nv">table</span><span class="p">)</span>
	<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">null?</span> <span class="nv">keys</span><span class="p">)</span>
	    <span class="nv">table</span>
	    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">subtable</span>
		   <span class="p">(</span><span class="nv">assoc</span>
		    <span class="p">(</span><span class="nv">car</span> <span class="nv">keys</span><span class="p">)</span>
		    <span class="nv">table</span><span class="p">)))</span>
	      <span class="p">(</span><span class="k">if </span><span class="nv">subtable</span>
		  <span class="p">(</span><span class="nv">recursive</span>
		   <span class="p">(</span><span class="nv">cdr</span> <span class="nv">keys</span><span class="p">)</span>
		   <span class="p">(</span><span class="nv">cdr</span> <span class="nv">subtable</span><span class="p">))</span>
		  <span class="no">#f</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">null?</span> <span class="nv">keys</span><span class="p">)</span>
	  <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;Keys should not be null&#34;</span><span class="p">)</span>
	  <span class="p">(</span><span class="nv">recursive</span> <span class="nv">keys</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">local-table</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">insert!</span> <span class="nv">keys</span> <span class="nv">value</span><span class="p">)</span>
      <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">recursive</span> <span class="nv">keys</span> <span class="nv">table</span><span class="p">)</span>
	<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nv">not</span> <span class="p">(</span><span class="nv">pair?</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">table</span><span class="p">)))</span>
		 <span class="p">(</span><span class="nv">not</span> <span class="p">(</span><span class="nv">null?</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">table</span><span class="p">))))</span>
	    <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">table</span> <span class="o">&#39;</span><span class="p">()))</span>	<span class="c1">;overwrittern the key-value with new table</span>
	<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">subtable</span> <span class="p">(</span><span class="nv">assoc</span>
			 <span class="p">(</span><span class="nv">car</span> <span class="nv">keys</span><span class="p">)</span>
			 <span class="p">(</span><span class="nv">cdr</span> <span class="nv">table</span><span class="p">)))</span>
	      <span class="p">(</span><span class="nv">left</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">keys</span><span class="p">))</span>
	      <span class="p">(</span><span class="nv">first</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">keys</span><span class="p">))</span>
	      <span class="p">(</span><span class="nv">left-tables</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">table</span><span class="p">)))</span>
	  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">and </span><span class="nv">subtable</span> <span class="p">(</span><span class="nv">null?</span> <span class="nv">left</span><span class="p">))</span>
		 <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">subtable</span> <span class="nv">value</span><span class="p">)</span>
		 <span class="ss">&#39;ok</span><span class="p">)</span>
		<span class="p">((</span><span class="k">and </span><span class="nv">subtable</span> <span class="p">(</span><span class="nv">not</span> <span class="p">(</span><span class="nv">null?</span> <span class="nv">left</span><span class="p">)))</span>
		 <span class="p">(</span><span class="nv">recursive</span> <span class="nv">left</span> <span class="nv">subtable</span><span class="p">))</span>
		<span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nv">not</span> <span class="nv">subtable</span><span class="p">)</span> <span class="p">(</span><span class="nv">not</span> <span class="p">(</span><span class="nv">null?</span> <span class="nv">left</span><span class="p">)))</span>
		 <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">sub</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">first</span> <span class="o">&#39;</span><span class="p">())))</span>
		   <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">table</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">sub</span> <span class="nv">left-tables</span><span class="p">))</span>
		   <span class="p">(</span><span class="nv">recursive</span> <span class="nv">left</span> <span class="nv">sub</span><span class="p">)))</span>
		<span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nv">not</span> <span class="nv">subtable</span><span class="p">)</span> <span class="p">(</span><span class="nv">null?</span> <span class="nv">left</span><span class="p">))</span>
		 <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">sub</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">first</span> <span class="nv">value</span><span class="p">)))</span>
		   <span class="p">(</span><span class="nv">set-cdr!</span> <span class="nv">table</span> <span class="p">(</span><span class="nv">cons</span> <span class="nv">sub</span> <span class="nv">left-tables</span><span class="p">))</span>
		   <span class="ss">&#39;ok</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">null?</span> <span class="nv">keys</span><span class="p">)</span>
	  <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;Keys should not be null&#34;</span><span class="p">)</span>
	  <span class="p">(</span><span class="nv">recursive</span> <span class="nv">keys</span> <span class="nv">local-table</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">assoc</span> <span class="nv">key</span> <span class="nv">records</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">null?</span> <span class="nv">records</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">equal?</span> <span class="nv">key</span> <span class="p">(</span><span class="nv">caar</span> <span class="nv">records</span><span class="p">))</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">records</span><span class="p">))</span>
	    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nv">assoc</span> <span class="nv">key</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">records</span><span class="p">)))))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">dispatch</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;lookup-proc</span><span class="p">)</span> <span class="nv">lookup</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;insert-proc!</span><span class="p">)</span> <span class="nv">insert!</span><span class="p">)</span>
	    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nv">error</span> <span class="s">&#34;Unknown operation -- TABLE&#34;</span> <span class="nv">m</span><span class="p">))))</span>
    <span class="nv">dispatch</span><span class="p">))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-26">3.26</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">lookup-t</span> <span class="nv">given-key</span> <span class="nv">set-of-records</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">null?</span> <span class="nv">set-of-records</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
	<span class="p">((</span><span class="nv">=</span> <span class="nv">given-key</span> <span class="p">(</span><span class="nv">key</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set-of-records</span><span class="p">)))</span>
	 <span class="p">(</span><span class="nv">entry</span> <span class="nv">set-of-records</span><span class="p">))</span>
	<span class="p">((</span><span class="nv">&gt;</span> <span class="nv">given-key</span> <span class="p">(</span><span class="nv">key</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set-of-records</span><span class="p">)))</span>
	 <span class="p">(</span><span class="nv">lookup-t</span> <span class="nv">given-key</span> <span class="p">(</span><span class="nv">right-branch</span> <span class="nv">set-of-records</span><span class="p">)))</span>
	<span class="p">((</span><span class="nv">&lt;</span> <span class="nv">given-key</span> <span class="p">(</span><span class="nv">key</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set-of-records</span><span class="p">)))</span>
	 <span class="p">(</span><span class="nv">lookup-t</span> <span class="nv">given-key</span> <span class="p">(</span><span class="nv">left-branch</span> <span class="nv">set-of-records</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">entry</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">left-branch</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nv">cadr</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">right-branch</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nv">caddr</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-tree</span> <span class="nv">entry</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">list</span> <span class="nv">entry</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">adjoin-set</span> <span class="nv">data</span> <span class="nv">set</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">k</span> <span class="p">(</span><span class="nv">key</span> <span class="nv">data</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">i</span> <span class="p">(</span><span class="nv">item</span> <span class="nv">data</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">null?</span> <span class="nv">set</span><span class="p">)</span> <span class="p">(</span><span class="nv">make-tree</span> <span class="nv">data</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">()))</span>
	  <span class="p">((</span><span class="nv">=</span> <span class="nv">k</span> <span class="p">(</span><span class="nv">key</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set</span><span class="p">)))</span>
	   <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="nv">set-item!</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set</span><span class="p">)</span> <span class="nv">i</span><span class="p">)</span> <span class="nv">set</span><span class="p">))</span>
	  <span class="p">((</span><span class="nv">&lt;</span> <span class="nv">k</span> <span class="p">(</span><span class="nv">key</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set</span><span class="p">)))</span>
	   <span class="p">(</span><span class="nv">make-tree</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set</span><span class="p">)</span>
		      <span class="p">(</span><span class="nv">adjoin-set</span> <span class="nv">data</span> <span class="p">(</span><span class="nv">left-branch</span> <span class="nv">set</span><span class="p">))</span>
		      <span class="p">(</span><span class="nv">right-branch</span> <span class="nv">set</span><span class="p">)))</span>
	  <span class="p">((</span><span class="nv">&gt;</span> <span class="nv">k</span> <span class="p">(</span><span class="nv">key</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set</span><span class="p">)))</span>
	   <span class="p">(</span><span class="nv">make-tree</span> <span class="p">(</span><span class="nv">entry</span> <span class="nv">set</span><span class="p">)</span>
		      <span class="p">(</span><span class="nv">left-branch</span> <span class="nv">set</span><span class="p">)</span>
		      <span class="p">(</span><span class="nv">adjoin-set</span> <span class="nv">data</span> <span class="p">(</span><span class="nv">right-branch</span> <span class="nv">set</span><span class="p">)))))))</span>

<span class="c1">;; table</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-data</span> <span class="nv">key</span> <span class="nv">item</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">list</span> <span class="nv">key</span> <span class="nv">item</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">key</span> <span class="nv">data</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">car</span> <span class="nv">data</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">item</span> <span class="nv">data</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">cadr</span> <span class="nv">data</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">set-item!</span> <span class="nv">data</span> <span class="nv">item</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">set-car!</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">data</span><span class="p">)</span> <span class="nv">item</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">make-table</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">local-table</span> <span class="o">&#39;</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">lookup</span> <span class="nv">key-1</span> <span class="nv">key-2</span><span class="p">)</span>	<span class="c1">;also applicable to key-list (recursive proc needed)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">subtable</span> <span class="p">(</span><span class="nv">lookup-t</span> <span class="nv">key-1</span> <span class="nv">local-table</span><span class="p">)))</span>
	<span class="p">(</span><span class="k">if </span><span class="nv">subtable</span>
	    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">record</span> <span class="p">(</span><span class="nv">lookup-t</span> <span class="nv">key-2</span> <span class="p">(</span><span class="nv">item</span> <span class="nv">subtable</span><span class="p">))))</span>
	      <span class="p">(</span><span class="k">if </span><span class="nv">record</span>
		  <span class="p">(</span><span class="nv">item</span> <span class="nv">record</span><span class="p">)</span>
		  <span class="no">#f</span><span class="p">))</span>
	    <span class="no">#f</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">insert!</span> <span class="nv">key-1</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">subtable</span> <span class="p">(</span><span class="nv">lookup-t</span> <span class="nv">key-1</span> <span class="nv">local-table</span><span class="p">)))</span>
	<span class="p">(</span><span class="k">if </span><span class="nv">subtable</span>
	    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">record</span> <span class="p">(</span><span class="nv">lookup-t</span> <span class="nv">key-2</span> <span class="p">(</span><span class="nv">item</span> <span class="nv">subtable</span><span class="p">))))</span>
	      <span class="p">(</span><span class="k">if </span><span class="nv">record</span>
		  <span class="p">(</span><span class="nv">set-item!</span> <span class="nv">record</span> <span class="nv">item</span><span class="p">)</span> <span class="c1">;overwrittern</span>
		  <span class="p">(</span><span class="nv">set-item!</span> <span class="nv">subtable</span>
			<span class="p">(</span><span class="nv">adjoin-set</span>
			 <span class="p">(</span><span class="nv">make-data</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">)</span>
			 <span class="p">(</span><span class="nv">item</span> <span class="nv">subtable</span><span class="p">)))))</span>
	    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">new-subtable</span>
		   <span class="p">(</span><span class="nv">make-data</span>
		    <span class="nv">key-1</span>
		    <span class="p">(</span><span class="nv">make-tree</span>
		     <span class="p">(</span><span class="nv">make-data</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">)</span>
		     <span class="o">&#39;</span><span class="p">()</span>
		     <span class="o">&#39;</span><span class="p">()))))</span>
	      <span class="p">(</span><span class="k">set! </span><span class="nv">local-table</span> <span class="p">(</span><span class="nv">adjoin-set</span> <span class="nv">new-subtable</span> <span class="nv">local-table</span><span class="p">))))</span>
      <span class="nv">local-table</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">dispatch</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;lookup-proc</span><span class="p">)</span> <span class="nv">lookup</span><span class="p">)</span>
	    <span class="p">((</span><span class="nv">eq?</span> <span class="nv">m</span> <span class="ss">&#39;insert-proc!</span><span class="p">)</span> <span class="nv">insert!</span><span class="p">)</span>
	    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nv">error</span> <span class="s">&#34;Unknown operation -- TABLE&#34;</span> <span class="nv">m</span><span class="p">))))</span>
    <span class="nv">dispatch</span><span class="p">))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-27">3.27</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; memo-fib 能以正比于 n 的步数计算出第 n 个斐波那契数；</span>

<span class="c1">;; 是因为在斐波那契的树形递归过程中，memo-fib 过程将对于更小的 n 计算完成的中间</span>
<span class="c1">;; 结果存储在表格中，然后在计算更大的 n 的斐波那契数时就可以直接去表格里去取 n-1</span>
<span class="c1">;; 和 n-2 的对应结果，然后相加即完成计算，这样一次计算只需要常量步骤；</span>

<span class="c1">;; 所以结论成立。</span>

<span class="c1">;; 将 memo-fib 定义为 (memoize fib), 这一模式就不能工作了，只会以原来的 fib 的工</span>
<span class="c1">;; 作模式运行，消耗大量时间计算，因为 fib 的过程体中并没有调用 memo-fib 而是 fib</span>
<span class="c1">;; 自己，也就是说，(let ((result (f x)))) 这行代码将使用 fib 直接计算出结果而不</span>
<span class="c1">;; 会利用表格存储中间结果。</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="数字电路的模拟器">数字电路的模拟器</h3>

<ol>
<li>事件驱动的模拟程序系统：在这类系统里，一些活动（“事件”）引发另一些在随后
时间发生的事件，它们又会引发随后的事件，并如此继续下去；</li>
<li>在一个可以将过程当作对象的语言里，在“过程”和“数据”之间并没有本质性的差异，
因此我们可以自由选择自己所需的语法糖衣，以便按自己选定的风格去做程序设计；</li>
</ol>

<h3 id="练习-3-dot-28-3-dot-32">练习 3.28-3.32</h3>

<h4 id="3-dot-28">3.28</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">and-gate</span> <span class="nv">a1</span> <span class="nv">a2</span> <span class="nv">output</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">and-action-procedure</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">new-value</span>
	   <span class="p">(</span><span class="nv">logical-and</span> <span class="p">(</span><span class="nv">get-signal</span> <span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nv">get-signal</span> <span class="nv">a2</span><span class="p">))))</span>
      <span class="p">(</span><span class="nv">after-delay</span> <span class="nv">and-gate-delay</span>
		   <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
		     <span class="p">(</span><span class="nv">set-signal!</span> <span class="nv">output</span> <span class="nv">new-value</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nv">add-action!</span> <span class="nv">a1</span> <span class="nv">and-action-procedure</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">add-action!</span> <span class="nv">a2</span> <span class="nv">and-action-procedure</span><span class="p">)</span>
  <span class="ss">&#39;ok</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">or-gate</span> <span class="nv">a1</span> <span class="nv">a2</span> <span class="nv">output</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">or-action-procedure</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">new-value</span>
	   <span class="p">(</span><span class="nv">logical-or</span> <span class="p">(</span><span class="nv">get-signal</span> <span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nv">get-signal</span> <span class="nv">a2</span><span class="p">))))</span>
      <span class="p">(</span><span class="nv">after-delay</span> <span class="nv">or-gate-delay</span>
		   <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
		     <span class="p">(</span><span class="nv">set-signal!</span> <span class="nv">output</span> <span class="nv">new-value</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nv">add-action!</span> <span class="nv">a1</span> <span class="nv">or-action-procedure</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">add-action!</span> <span class="nv">a2</span> <span class="nv">or-action-procedure</span><span class="p">)</span>
  <span class="ss">&#39;ok</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">logical-and</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nv">=</span> <span class="nv">s1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">=</span> <span class="nv">s2</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nv">=</span> <span class="nv">s1</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nv">=</span> <span class="nv">s2</span> <span class="mi">1</span><span class="p">))</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">(</span><span class="nv">else</span>
	 <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;Invalid signal&#34;</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">logical-or</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nv">=</span> <span class="nv">s1</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nv">=</span> <span class="nv">s2</span> <span class="mi">1</span><span class="p">))</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nv">=</span> <span class="nv">s1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">=</span> <span class="nv">s2</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">(</span><span class="nv">else</span>
	 <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;Invalid signal&#34;</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">))))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-29">3.29</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; (A or B) 等价于 (not ((not A) and (not B)))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">or-gate</span> <span class="nv">a1</span> <span class="nv">a2</span> <span class="nv">output</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">invert-1</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">invert-2</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">and-invert1-invert2</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">inverter</span> <span class="nv">a1</span> <span class="nv">invert-1</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">inverter</span> <span class="nv">a2</span> <span class="nv">invert-2</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">and-gate</span> <span class="nv">invert-1</span> <span class="nv">invert-2</span> <span class="nv">and-invert1-invert2</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">inverter</span> <span class="nv">and-invert1-invert2</span> <span class="nv">output</span><span class="p">))</span>
  <span class="ss">&#39;ok</span><span class="p">)</span>

<span class="c1">;; 这样的或门最大延时 (+ (* 3 inverter-delay) and-gate-delay)</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-30">3.30</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">full-adder</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c-in</span> <span class="nv">sum</span> <span class="nv">c-out</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">s</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">c1</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">c2</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">half-adder</span> <span class="nv">b</span> <span class="nv">c-in</span> <span class="nv">a</span> <span class="nv">c1</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">half-adder</span> <span class="nv">a</span> <span class="nv">s</span> <span class="nv">sum</span> <span class="nv">c2</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">or-gate</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">c-out</span><span class="p">)</span>
    <span class="ss">&#39;ok</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">half-adder</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">s</span> <span class="nv">c</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">d</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">e</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">or-gate</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">d</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">and-gate</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">inverter</span> <span class="nv">c</span> <span class="nv">e</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">and-gate</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">s</span><span class="p">)</span>
    <span class="ss">&#39;ok</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">ripple-carry-adder</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">s</span> <span class="nv">c</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">c0</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">c1</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">set-signal!</span> <span class="nv">c0</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">recursive</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c-in</span> <span class="nv">sum</span> <span class="nv">c-out</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">null?</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">a</span><span class="p">))</span>
	  <span class="p">(</span><span class="nv">begin</span>
	    <span class="p">(</span><span class="nv">full-adder</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">c-in</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">s</span><span class="p">)</span> <span class="nv">c</span><span class="p">)</span>
	    <span class="ss">&#39;ok</span><span class="p">)</span>
	  <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="nv">full-adder</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">c-in</span> <span class="p">(</span><span class="nv">car</span> <span class="nv">s</span><span class="p">)</span> <span class="nv">c-out</span><span class="p">)</span>
		 <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">c-in</span> <span class="nv">c-out</span><span class="p">)</span>
		       <span class="p">(</span><span class="nv">c-out</span> <span class="p">(</span><span class="nv">make-wire</span><span class="p">)))</span>
		   <span class="p">(</span><span class="nv">recursive</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">c-in</span> <span class="p">(</span><span class="nv">cdr</span> <span class="nv">s</span><span class="p">)</span> <span class="nv">c-out</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nv">recursive</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c0</span> <span class="nv">s</span> <span class="nv">c1</span><span class="p">)))</span>

<span class="c1">;; 大概统计：</span>
<span class="c1">;; let ((half-adder-delay (+ or-gate-delay (* 2 and-gate-delay) inverter-delay)))</span>
<span class="c1">;; let ((full-adder-delay (+ (* 2 half-adder-delay) or-gate-delay)))</span>
<span class="c1">;; let ((ripple-darry-adder-n-delay (* n full-adder-delay)))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-31">3.31</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 当一个新的动作过程加入线路时，这一过程应立即运行，这样将会把一项新日程加入日</span>
<span class="c1">;; 程表，当调用过程 propagate 时就会按时间顺序调用日程；</span>

<span class="c1">;; 如果不这样做的话，以反门为例子，如果不在新的动作加入输入线路时立即执行，那么</span>
<span class="c1">;; 日程表里将没有项目，propagate 过程没有任何调用活动立即结束，而反门的输出将保</span>
<span class="c1">;; 持默认值不被修改，而这是与反门的逻辑相违背的。</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-32">3.32</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 有些时候后续操作将依赖于前面的操作；</span>

<span class="c1">;; 与门，输入在一个时间段里从 0 1 变为 1 0；</span>

<span class="c1">;; 当 input1 从 0 变为 1 时，input2 仍然是 1；</span>
<span class="c1">;; input1 的信号变化将一日程项目加入日程表，而此日程项目的局部状态变量</span>
<span class="c1">;; new-value 将是当前两个输入值的逻辑与，即为 1;</span>

<span class="c1">;; 依次类推，input2 从 1 变为 0 时，input1 为 1;</span>
<span class="c1">;; 则...</span>
<span class="c1">;; 新加入的日程项目的局部状态变量将是 0;</span>

<span class="c1">;; 按后进先出顺序处理日程项目，所以 input2 相关的项目先调用，input1 的后调用；</span>
<span class="c1">;; 此后与门的输出为 1，与与门逻辑不符合。</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="约束的传播">约束的传播</h3>

<ol>
<li>描绘一种语言的设计，这种语言将使我们可以基于各种关系进行工作，这一语言里
的基本元素就是 <strong>基本约束</strong>, 它们描述了在不同量之间的某种特定关系；还提供了
一些方法，使它们可以用于组合各种基本约束，以便去描绘更复杂的关系；</li>
<li>非定向的计算是基于约束的系统的标志性特征；</li>
</ol>

<h3 id="练习-3-dot-33-3-dot-37">练习 3.33-3.37</h3>

<h4 id="3-dot-33">3.33</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="nv">a</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="nv">b</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="nv">c</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">averager</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">u</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">v</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">multiplier</span> <span class="nv">u</span> <span class="nv">c</span> <span class="nv">v</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">adder</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">v</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">constant</span> <span class="mi">2</span> <span class="nv">u</span><span class="p">)</span>
    <span class="ss">&#39;ok</span><span class="p">))</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-34">3.34</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 如果只是设置了 a 的值，b 的值是可以计算出来的；</span>
<span class="c1">;; 反之则不然；</span>
<span class="c1">;; 因为当我们想计算 b 的平方根时，必须设置 b 的值同时使 a 忘记值；</span>
<span class="c1">;; multiplier 过程的内部过程 process-new-value 中的所有 cond 条件全部无法通过；</span>
<span class="c1">;; 无法为 a 设置新值。</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-35">3.35</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">squarer</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">process-new-value</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">has-value?</span> <span class="nv">b</span><span class="p">)</span>
	<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">&lt;</span> <span class="p">(</span><span class="nv">get-value</span> <span class="nv">b</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
	    <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;square less than 0 -- SQUARER&#34;</span> <span class="p">(</span><span class="nv">get-value</span> <span class="nv">b</span><span class="p">))</span>
	    <span class="p">(</span><span class="nv">set-value!</span> <span class="nv">a</span>
			<span class="p">(</span><span class="nv">sqrt</span> <span class="p">(</span><span class="nv">get-value</span> <span class="nv">b</span><span class="p">))</span>
			<span class="nv">me</span><span class="p">))</span>
	<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nv">has-value?</span> <span class="nv">a</span><span class="p">)</span>
	    <span class="p">(</span><span class="nv">set-value!</span> <span class="nv">b</span>
			<span class="p">(</span><span class="nv">square</span> <span class="p">(</span><span class="nv">get-value</span> <span class="nv">a</span><span class="p">))</span>
			<span class="nv">me</span><span class="p">))))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">process-forget-value</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">forget-value!</span> <span class="nv">a</span> <span class="nv">me</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">forget-value!</span> <span class="nv">b</span> <span class="nv">me</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">process-new-value</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">me</span> <span class="nv">request</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nv">eq?</span> <span class="nv">request</span> <span class="ss">&#39;I-have-a-value</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">process-new-value</span><span class="p">))</span>
	  <span class="p">((</span><span class="nv">eq?</span> <span class="nv">request</span> <span class="ss">&#39;I-lost-my-value</span><span class="p">)</span>
	   <span class="p">(</span><span class="nv">process-forget-value</span><span class="p">))</span>
	  <span class="p">(</span><span class="nv">else</span>
	   <span class="p">(</span><span class="nv">error</span> <span class="s">&#34;Unknown request -- SQUARER&#34;</span> <span class="nv">request</span><span class="p">))))</span>
  <span class="p">(</span><span class="nv">connect</span> <span class="nv">a</span> <span class="nv">me</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">connect</span> <span class="nv">b</span> <span class="nv">me</span><span class="p">)</span>
  <span class="nv">me</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-36">3.36</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 这个题目应该还是 ex 3.35 的后续；</span>
<span class="c1">;; 没必要画图，耐心一些总能画出来，总体环境结构再复杂也是由简单环境组成的。</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-dot-37">3.37</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scheme" data-lang="scheme"><span class="c1">;; 暂时忘掉底层抽象，在更高的抽象层次上思考问题。</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">celsius-fahrenheit-converter</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">c+</span> <span class="p">(</span><span class="nv">c*</span> <span class="p">(</span><span class="nv">c/</span> <span class="p">(</span><span class="nv">cv</span> <span class="mi">9</span><span class="p">)</span> <span class="p">(</span><span class="nv">cv</span> <span class="mi">5</span><span class="p">))</span>
	  <span class="nv">x</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">cv</span> <span class="mi">32</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">C</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="nv">F</span> <span class="p">(</span><span class="nv">celsius-fahrenheit-converter</span> <span class="nv">C</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">c+</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">z</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">adder</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
    <span class="nv">z</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">cv</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">y</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">constant</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="nv">y</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">c*</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">z</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">multiplier</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
    <span class="nv">z</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">c/</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">z</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">multiplier</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">x</span><span class="p">)</span>
    <span class="nv">z</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nv">c-</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nv">z</span> <span class="p">(</span><span class="nv">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">adder</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">x</span><span class="p">)</span>
    <span class="nv">z</span><span class="p">))</span></code></pre></td></tr></table>
</div>
</div>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">zero4drift</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">2019-01-14</span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://zero4drift.github.io/tags/sicp/">SICP</a>
          <a href="https://zero4drift.github.io/tags/scheme/">Scheme</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/posts/sicp-refresher-chapter-34/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">SICP-Refresher-Chapter-3(4)</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/posts/sicp-refresher-chapter-32/">
            <span class="next-text nav-default">SICP-Refresher-Chapter-3(2)</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "zero4drift/comments-for-my-blog"
            issue-term="pathname"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  
  
    



        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
  
    <a href="fang0052@e.ntu.edu.sg" rel="me noopener" class="iconfont"
      title="email"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/zero4drift" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://zero4drift.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
  
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2018 -
    2019
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        zero4drift
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>

  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>





  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>










</body>
</html>
