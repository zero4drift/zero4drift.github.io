<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Refresher of SICP chapter 2.2 abstraction data 构造数据抽象">
<meta name="viewport" content="width=device-width">
<title>SICP-Refresher-Chapter-2(2) | 钉钉是世界上最傻逼的app</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://zero4drift.github.io/posts/sicp-refresher-chapter-2%282%29/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="zero4drift">
<meta property="og:site_name" content="钉钉是世界上最傻逼的app">
<meta property="og:title" content="SICP-Refresher-Chapter-2(2)">
<meta property="og:url" content="https://zero4drift.github.io/posts/sicp-refresher-chapter-2%282%29/">
<meta property="og:description" content="Refresher of SICP chapter 2.2 abstraction data 构造数据抽象">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-12-18T13:45:33+08:00">
<meta property="article:tag" content="Scheme">
<meta property="article:tag" content="SICP">
</head>
<body>
    

    <header id="header" class="navbar"><div class="container">
            
    <div class="brand">

        <div class="brand-text">
            <a href="https://zero4drift.github.io/" title="钉钉是世界上最傻逼的app" rel="home">
                钉钉是世界上最傻逼的app
            </a>
        </div>

        <a id="btn-toggle-nav" class="navbar-toggle">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
    </div>

            
    <nav class="navbar-collapse collapse"><ul class="nav">
<li><a href="../../archive.html">Archive</a></li>
                <li><a href="https://github.com/zero4drift">Github</a></li>
                <li><a href="../../categories/">Tags</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>
    
    
    </ul></nav>
</div>
    </header><div class="header-padding"> </div>

    
    <div class="post-header">
        <div class="container">
            <div class="title">
                SICP-Refresher-Chapter-2(2)
            </div>
        </div>
    </div>

    <div class="post-meta">
      <div class="container">
	<div class="meta clearfix">
	  <div class="authordate">
	    <time class="timeago" datetime="2018-12-18T13:45:33+08:00">2018/12/18</time>
</div>
	  <div class="post-tags">
	    <div class="tag">
	      <a href="../../categories/scheme/" rel="tag">Scheme</a>
	    </div>
	    <div class="tag">
	      <a href="../../categories/sicp/" rel="tag">SICP</a>
	    </div>
	  </div>
	</div>
      </div>
    </div>
    
    
    <div id="post-main" class="main">
        <div class="container">
        <div id="outline-container-orgdcffc81" class="outline-2">
<h2 id="orgdcffc81">层次性数据和闭包性质</h2>
<div class="outline-text-2" id="text-orgdcffc81">
<ol class="org-ol">
<li>序对使用的是一种被称为 <b>盒子和指针</b> 的表示方式：
<ol class="org-ol">
<li>序对的每个对象表示为指向 <b>盒子</b> 的 <b>指针</b>;</li>
<li>与序对的元素相对应的 <b>盒子</b> 里包含着该元素的表示。</li>
</ol>
</li>
<li>用于表示序对的结构实际上是一对方盒，其中左边的方盒里放着序对的 car（指向
car 的指针），右边部分放着相应的 cdr（指向 cdr 的指针）；</li>
<li>序对就是一种通用的建筑砌块，通过它可以构造起所有不同种类的数据结构来；</li>
<li>建立元素本身也是序对的序对，是 <b>表结构</b> 得以作为一种表示工具的根本基础，这
种能力称为 cons 的 <b>闭包</b> 性质：即组合起数据对象得到的结果本身还可以通过同
样的操作再进行组合，建立起 <b>层次性</b> 的结构；</li>
<li>第一章中开始，就提到，组合式的成员本身还可以是组合式，也是闭包性质的一种体
现。</li>
</ol>
</div>

<div id="outline-container-org496e909" class="outline-3">
<h3 id="org496e909">序列的表示</h3>
<div class="outline-text-3" id="text-org496e909">
<ol class="org-ol">
<li>在用序对构成的层次性结构的一种链条表示中，最后的一个序对的 cdr 用一个能辨
明不是序对的值表示，标明序列的结束，在程序里用变量 nil 的值；</li>
<li>术语 <b>表</b> 专指那些有表尾结束标记的序对的链；相对应的，术语 <b>表结构</b> 指所
有的由序对构造起来的数据结构，而不仅是 <b>表</b>;</li>
<li>
<code>(list &lt;a1&gt; &lt;a2&gt; ... &lt;a3&gt;)</code> 等价于 <code>(cons &lt;a1&gt; (cons &lt;a2&gt; (cons
       ... (cons &lt;an&gt; nil)...)))</code> ;</li>
<li>nil 也可以当作一个不包含任何元素的序列： <b>空表</b>;</li>
<li>嵌套应用 car 和 cdr 可以取出一个表里的第二，第三以及后面的各项，但是使用
起来比较麻烦，提供缩写形式：cadr, 所有这类过程的名字都以 c 开头，以 r 结
束，其中的每个 a 表示一个 car 操作，每个 d 表示一个 cdr 操作，按照它们在
名字中出现的顺序应用；</li>
<li>表操作：
<ol class="org-ol">
<li>list-ref 返回表中的第 n 项（表元素编号从0开始）；</li>
<li>null? 检查表是不是空表；</li>
<li>length 返回表的长度；</li>
<li>append 以两个表为参数，用它们的元素组合成一个新表；</li>
</ol>
</li>
<li>带点尾部记法：在一个过程定义中，如果在形式参数表的最后一个参数之前有一个
点号，那就表明，当这一过程被实际调用时，前面各个形式参数（如果有的话）将
以前面的各个实际参数为值，与平常一样。但最后一个形式参数将以所有剩下的实
际参数的表为值；</li>
<li>对表的映射：map
<ol class="org-ol">
<li>scheme 内置的 map 以一个取 n 个参数的过程和 n 个表为参数，将这个过程应
用于所有表的第一个元素，而后应用于它们的第二个元素，如此下去，最后返回
所有结果的 <b>表</b> ；</li>
<li>map 帮我们建立起了一层抽象屏障，将实现表转换的过程的实现，与如何提取表
中元素以及组合结果的细节隔离开，这种抽象也提供了新的灵活性，使我们有可
能在保持从序列到序列的变换操作框架的同时，改变序列实现的底层细节。</li>
</ol>
</li>
</ol>
</div>
</div>

<div id="outline-container-org5501702" class="outline-3">
<h3 id="org5501702">练习 2.17-2.23</h3>
<div class="outline-text-3" id="text-org5501702">
</div>
<div id="outline-container-org0bbdbee" class="outline-4">
<h4 id="org0bbdbee">2.17</h4>
<div class="outline-text-4" id="text-org0bbdbee">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">last-pair</span> <span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">left</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">)))</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">left</span><span class="p">)</span>
	     <span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">)</span>
	     <span class="p">(</span><span class="nf">last-pair</span> <span class="nv">left</span><span class="p">))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org6d01961" class="outline-4">
<h4 id="org6d01961">2.18</h4>
<div class="outline-text-4" id="text-org6d01961">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">reverse </span><span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">items</span> <span class="nv">result</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">items</span><span class="p">)</span>
	     <span class="nv">result</span>
	     <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">)</span> <span class="nv">result</span><span class="p">))))</span>
       <span class="p">(</span><span class="nf">iter</span> <span class="nv">items</span> <span class="o">'</span><span class="p">()))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3a5e3f4" class="outline-4">
<h4 id="org3a5e3f4">2.19</h4>
<div class="outline-text-4" id="text-org3a5e3f4">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="nv">us-coins</span> <span class="p">(</span><span class="nb">list </span><span class="mi">50</span> <span class="mi">25</span> <span class="mi">10</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="nv">uk-coins</span> <span class="p">(</span><span class="nb">list </span><span class="mi">100</span> <span class="mi">50</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mf">0.5</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="nv">coin-values</span><span class="p">)</span>
       <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
	     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">no-more?</span> <span class="nv">coin-values</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
	     <span class="p">(</span><span class="nf">else</span>
	      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span>
		     <span class="p">(</span><span class="nf">except-first-denomination</span> <span class="nv">coin-values</span><span class="p">))</span>
		 <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nb">- </span><span class="nv">amount</span>
			<span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">coin-values</span><span class="p">))</span>
		     <span class="nv">coin-values</span><span class="p">)))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">except-first-denomination</span> <span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">no-more?</span> <span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">null? </span><span class="nv">items</span><span class="p">))</span>

     <span class="c1">;; coin-values 的排列顺序不会影响 cc 给出的回答；</span>
     <span class="c1">;; 因为代码逻辑上具有一致性，排列顺序的不同只会影响中间结果，不会影响最终的解。</span>
</pre></div>
</div>
</div>

<div id="outline-container-org15480cd" class="outline-4">
<h4 id="org15480cd">2.20</h4>
<div class="outline-text-4" id="text-org15480cd">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">same-parity</span> <span class="nv">signal</span> <span class="o">.</span> <span class="nv">test</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fetch</span> <span class="nv">items</span> <span class="nv">p</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">items</span><span class="p">)</span>
	     <span class="nv">items</span>
	     <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">first</span> <span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">)))</span>
	       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">p</span> <span class="nv">first</span><span class="p">)</span>
		   <span class="p">(</span><span class="nb">cons </span><span class="nv">first</span> <span class="p">(</span><span class="nf">fetch</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">)</span> <span class="nv">p</span><span class="p">))</span>
		   <span class="p">(</span><span class="nf">fetch</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">)</span> <span class="nv">p</span><span class="p">)))))</span>
	 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">even? </span><span class="nv">signal</span><span class="p">)</span>
	   <span class="p">(</span><span class="nb">cons </span><span class="nv">signal</span> <span class="p">(</span><span class="nf">fetch</span> <span class="nv">test</span> <span class="nv">even?</span><span class="p">))</span>
	   <span class="p">(</span><span class="nb">cons </span><span class="nv">signal</span> <span class="p">(</span><span class="nf">fetch</span> <span class="nv">test</span> <span class="nv">odd?</span><span class="p">))))</span>      
</pre></div>
</div>
</div>

<div id="outline-container-org93b5e79" class="outline-4">
<h4 id="org93b5e79">2.21</h4>
<div class="outline-text-4" id="text-org93b5e79">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">square-list</span> <span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">items</span><span class="p">)</span>
	   <span class="o">'</span><span class="p">()</span>
	   <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">))</span> <span class="p">(</span><span class="nf">square-list</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">)))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">square-list</span> <span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">map </span><span class="nv">square</span> <span class="nv">items</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org0c58e6e" class="outline-4">
<h4 id="org0c58e6e">2.22</h4>
<div class="outline-text-4" id="text-org0c58e6e">
<div class="highlight"><pre><span></span>     <span class="c1">;; 主要是因为这条语句：(iter (cdr things) (cons (square (car things)) answer))</span>
     <span class="c1">;; 这样的话，逻辑上就是把传入的表参数的元素平方以后不停压入结果表，</span>
     <span class="c1">;; 最后的结果表的元素顺序与需求相反；</span>

     <span class="c1">;; 第二次修改 (iter (cdr things) (cons answer (square (car things))))</span>
     <span class="c1">;; 使序对层次结构的最后一个元素不是 nil.</span>
     <span class="c1">;; 这样计算的结果不但元素顺序没有修正，而且不是合法的‘表’表示了。</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgda137ae" class="outline-4">
<h4 id="orgda137ae">2.23</h4>
<div class="outline-text-4" id="text-orgda137ae">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">for-each </span><span class="nv">proc</span> <span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">items</span><span class="p">)</span>
	   <span class="nv">true</span>
	   <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="nf">proc</span> <span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">))</span>
		  <span class="p">(</span><span class="nb">for-each </span><span class="nv">proc</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org5089780" class="outline-3">
<h3 id="org5089780">层次性结构</h3>
<div class="outline-text-3" id="text-org5089780">
<ol class="org-ol">
<li>序列的元素本身也可以是序列，可以把这样的结构看作是 <b>树</b> ，而那些本身也是
序列的元素就是形成了树中的 <b>子树</b> ，往下深入直到序列元素不是序列时，把这种元
素当作树的 <b>叶子</b>;</li>
<li>表操作补遗：
<ol class="org-ol">
<li>pair? 检查参数是否为序对；</li>
</ol>
</li>
<li>map 与递归的结合也是处理树的一种强有力的抽象。</li>
</ol>
</div>
</div>

<div id="outline-container-org43da892" class="outline-3">
<h3 id="org43da892">练习 2.24-2.32</h3>
<div class="outline-text-3" id="text-org43da892">
</div>
<div id="outline-container-org4467c71" class="outline-4">
<h4 id="org4467c71">2.24</h4>
<div class="outline-text-4" id="text-org4467c71">
<div class="highlight"><pre><span></span>     <span class="c1">;; (1 (2 (3 4)))</span>
     <span class="c1">;; 盒子指针结构和树结构很容易理解，图示就免了。</span>
</pre></div>
</div>
</div>

<div id="outline-container-orga1c87e9" class="outline-4">
<h4 id="orga1c87e9">2.25</h4>
<div class="outline-text-4" id="text-orga1c87e9">
<div class="highlight"><pre><span></span>     <span class="c1">;; (1 3 (5 7) 9)</span>
     <span class="c1">;;(car (cdr (car (cdr (cdr '(1 3 (5 7) 9))))))</span>

     <span class="c1">;; ((7))</span>
     <span class="c1">;; (car (car '((7))))</span>

     <span class="c1">;; (1 (2 (3 (4 (5 (6 7)))))))</span>
     <span class="c1">;; (cadr (cadr (cadr (cadr (cadr (cadr third))))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org951a5b2" class="outline-4">
<h4 id="org951a5b2">2.26</h4>
<div class="outline-text-4" id="text-org951a5b2">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="nv">x</span> <span class="p">(</span><span class="nb">list </span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="nv">y</span> <span class="p">(</span><span class="nb">list </span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">))</span>

     <span class="c1">;; (append x y) '(1 2 3 4 5 6)</span>
     <span class="c1">;; (cons x y) '('(1 2 3) 4 5 6)</span>
     <span class="c1">;; (list x y) '('(1 2 3) '(4 5 6))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgcef667d" class="outline-4">
<h4 id="orgcef667d">2.27</h4>
<div class="outline-text-4" id="text-orgcef667d">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">deep-reverse</span> <span class="nv">items</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">items</span> <span class="nv">result</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">null? </span><span class="nv">items</span><span class="p">)</span> <span class="nv">result</span><span class="p">)</span>
	       <span class="p">((</span><span class="nb">pair? </span><span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">))</span>
		<span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">)</span>
		      <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">))</span> <span class="nv">result</span><span class="p">)))</span>
	       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">items</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">items</span><span class="p">)</span> <span class="nv">result</span><span class="p">)))))</span>
       <span class="p">(</span><span class="nf">iter</span> <span class="nv">items</span> <span class="o">'</span><span class="p">()))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orge47a258" class="outline-4">
<h4 id="orge47a258">2.28</h4>
<div class="outline-text-4" id="text-orge47a258">
<div class="highlight"><pre><span></span>     <span class="c1">;; (load "./2.18.scm")</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">append </span><span class="nv">list1</span> <span class="nv">list2</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">list1</span><span class="p">)</span>
	   <span class="nv">list2</span>
	   <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">list1</span><span class="p">)</span> <span class="p">(</span><span class="nb">append </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">list1</span><span class="p">)</span> <span class="nv">list2</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fringe</span> <span class="nv">tree</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">tree</span> <span class="nv">result</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">null? </span><span class="nv">tree</span><span class="p">)</span> <span class="nv">result</span><span class="p">)</span>
	       <span class="p">((</span><span class="nb">pair? </span><span class="p">(</span><span class="nb">car </span><span class="nv">tree</span><span class="p">))</span> <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">append </span><span class="p">(</span><span class="nf">fringe</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tree</span><span class="p">))</span> <span class="nv">result</span><span class="p">)))</span>
	       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">tree</span><span class="p">)</span> <span class="nv">result</span><span class="p">)))))</span>
       <span class="p">(</span><span class="nb">reverse </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">tree</span> <span class="o">'</span><span class="p">())))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgff05d93" class="outline-4">
<h4 id="orgff05d93">2.29</h4>
<div class="outline-text-4" id="text-orgff05d93">
<div class="highlight"><pre><span></span>     <span class="c1">;; a</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-mobile</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">list </span><span class="nv">left</span> <span class="nv">right</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-branch</span> <span class="nv">length</span> <span class="nv">structure</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">list </span><span class="nv">length</span> <span class="nv">structure</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">left-branch</span> <span class="nv">item</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">car </span><span class="nv">item</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">right-branch</span> <span class="nv">item</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">item</span><span class="p">)))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">branch-length</span> <span class="nv">branch</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">car </span><span class="nv">branch</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">branch-structure</span> <span class="nv">branch</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">branch</span><span class="p">)))</span>

     <span class="c1">;; b</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">total-weight</span> <span class="nv">item</span><span class="p">)</span>
       <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">recursive</span> <span class="nv">item</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">null? </span><span class="nv">item</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
	       <span class="p">((</span><span class="nb">number? </span><span class="nv">item</span><span class="p">)</span> <span class="nv">item</span><span class="p">)</span>
	       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">recursive</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">item</span><span class="p">)))</span>
			<span class="p">(</span><span class="nf">recursive</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">item</span><span class="p">)))))))</span>
       <span class="p">(</span><span class="nf">recursive</span> <span class="nv">item</span><span class="p">))</span>

     <span class="c1">;; c</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">total-moment</span> <span class="nv">item</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">branch-length</span> <span class="nv">item</span><span class="p">)</span> <span class="p">(</span><span class="nf">total-weight</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="nv">item</span><span class="p">))))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">balance?</span> <span class="nv">item</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">item</span><span class="p">))</span>
	   <span class="nv">true</span>
	   <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">left</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">item</span><span class="p">))</span> <span class="p">(</span><span class="nf">right</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">item</span><span class="p">)))</span>
	     <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">total-moment</span> <span class="nv">left</span><span class="p">)</span> <span class="p">(</span><span class="nf">total-moment</span> <span class="nv">right</span><span class="p">))</span>
		  <span class="p">(</span><span class="nf">balance?</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="nv">left</span><span class="p">))</span>
		  <span class="p">(</span><span class="nf">balance?</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="nv">right</span><span class="p">))))))</span>

     <span class="c1">;; d</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-mobile-mod</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons </span><span class="nv">left</span> <span class="nv">right</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-branch-mod</span> <span class="nv">length</span> <span class="nv">structure</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons </span><span class="nv">length</span> <span class="nv">structure</span><span class="p">))</span>


     <span class="c1">;; just modify right-branch and branch-structure</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">right-branch-mod</span> <span class="nv">item</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cdr </span><span class="nv">item</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">branch-structure-mod</span> <span class="nv">branch</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cdr </span><span class="nv">branch</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org4e17841" class="outline-4">
<h4 id="org4e17841">2.30</h4>
<div class="outline-text-4" id="text-org4e17841">
<div class="highlight"><pre><span></span>     <span class="c1">;; with map</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">square-tree</span> <span class="nv">tree</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">sub-tree</span><span class="p">)</span>
	      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">sub-tree</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">square-tree</span> <span class="nv">sub-tree</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">square</span> <span class="nv">sub-tree</span><span class="p">)))</span>
	    <span class="nv">tree</span><span class="p">))</span>

     <span class="c1">;; without map</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">square-tree-simple</span> <span class="nv">tree</span><span class="p">)</span>
       <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">null? </span><span class="nv">tree</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
	     <span class="p">((</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">tree</span><span class="p">))</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">tree</span><span class="p">))</span>
	     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">square-tree-simple</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tree</span><span class="p">))</span>
			 <span class="p">(</span><span class="nf">square-tree-simple</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tree</span><span class="p">))))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org2c4bc4e" class="outline-4">
<h4 id="org2c4bc4e">2.31</h4>
<div class="outline-text-4" id="text-org2c4bc4e">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">tree-map</span> <span class="nv">op</span> <span class="nv">tree</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">sub-tree</span><span class="p">)</span>
	      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">sub-tree</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">tree-map</span> <span class="nv">op</span> <span class="nv">sub-tree</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">op</span> <span class="nv">sub-tree</span><span class="p">)))</span>
	    <span class="nv">tree</span><span class="p">))</span>

     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">square-tree</span> <span class="nv">tree</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">tree-map</span> <span class="nv">square</span> <span class="nv">tree</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgf145be5" class="outline-4">
<h4 id="orgf145be5">2.32</h4>
<div class="outline-text-4" id="text-orgf145be5">
<div class="highlight"><pre><span></span>     <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">subsets</span> <span class="nv">s</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">s</span><span class="p">)</span>
	   <span class="p">(</span><span class="nb">list </span><span class="o">'</span><span class="p">())</span>
	   <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">rest</span> <span class="p">(</span><span class="nf">subsets</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">s</span><span class="p">))))</span>
	     <span class="p">(</span><span class="nb">append </span><span class="nv">rest</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
				 <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">s</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>
			       <span class="nv">rest</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-orgc194681" class="outline-3">
<h3 id="orgc194681">序列作为一种约定的界面</h3>
<div class="outline-text-3" id="text-orgc194681">
<ol class="org-ol">
<li>将注意力集中在处理过程中从一个步骤流向下一个步骤的“信号”，如果用一些表来
表示这些信号，那么就可以利用表操作实现每一步骤的处理；</li>
<li>将程序表示为一些针对序列的操作，这样做的价值就在于能帮助我们得到 <b>模块化</b>
的程序设计，也就是说，得到由一些比较独立的片段的组合构成的设计；</li>
<li>模块化结构是控制复杂性的一种威力强大的策略，能形成一个可以 <b>混合和匹配</b>
使用和搭配的标准的程序元素库；</li>
<li>在书中，用表实现的序列被作为一种方便的接口，可以利用这种接口去组合去组合
起各种处理模块；</li>
<li>而且有了一种统一的数据表示结构，就可以将程序对数据结构的依赖性局限到不多
的数据结构操作上，只要修改这些操作并保持接口约定，就能在数据结构的不同表
示之间切换，并保持程序的整体设计不变。</li>
</ol>
</div>
</div>

<div id="outline-container-orgdeeca86" class="outline-3">
<h3 id="orgdeeca86">练习 2.33-2.43</h3>
</div>

<div id="outline-container-orgc30cbbf" class="outline-3">
<h3 id="orgc30cbbf">实例：一个图形语言</h3>
</div>

<div id="outline-container-org7ff9ad5" class="outline-3">
<h3 id="org7ff9ad5">练习 2.44-2.52</h3>
</div>
</div>
            
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="https-zero4drift-github-io",
            disqus_url="https://zero4drift.github.io/posts/sicp-refresher-chapter-2%282%29/",
        disqus_title="SICP-Refresher-Chapter-2(2)",
        disqus_identifier="cache/posts/sicp-refresher-chapter-2(2).html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        
    


        </div>
    </div>

    
    <footer><div class="container">
            <div class="social">



                <div class="social-entry">
                    <a href="../../rss.xml" target="_blank">
                        <i class="fa fa-rss"></i> 
                    </a>
                </div>
            </div>
                <div class="copyright">
                    Contents © 2018         <a href="mailto:fang0052@e.ntu.edu.sg">zero4drift</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
                    
                </div>
           
        </div>
    </footer><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?06e0ade16d98033ac1aad78106d873c8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script src="../../assets/js/all-nocdn.js" type="text/javascript"></script>
</body>
</html>
